!function(e){var i=e(document);i.on("app-init",(function(){e.ajaxSetup({timeout:12e4}),e.extend(feedit,{callAPI:(n,t,o,a,l)=>(void 0!==t&&t?t.lang=window.lang_id:t={lang:window.lang_id},e.ajax(n,{method:"post",data:t}).done(o).fail((function(e,n,t){if(i.trigger("hide-loading"),"abort"!=n&&(void 0===a||!1!==a))switch(e.status){case 400:feedit.presentToast({txt:window.lang.system_error+": "+JSON.parse(e.responseText).error.detail,duration:5e3});break;case 401:feedit.presentToast({txt:window.lang.ajax_error_reload,duration:2500,buttons:[]}),setTimeout((function(){document.location.reload()}),2600);break;case 404:case 500:feedit.defaultErrorNotification();break;default:feedit.defaultErrorNotification()}"function"==typeof a&&a(e,n,t)})).always((function(){"function"==typeof l&&l()}))),defaultErrorNotification(){feedit.presentToast({txt:window.lang.ajax_error_maintenance,duration:2e4})}})}))}(jQuery),function(e){var i,n,t=e(document),o=!1,a=1,l=-1;t.on("app-init",(function(){i=e("#filter_sort"),n=e("#labels-select-badge"),t.on("refresh-content",(function(i,n,l,s,d,r){o||(e("#no_articles, #feed_error_info").addClass("ion-hide"),void 0!==r&&void 0!==r["no-loading"]&&r["no-loading"]||t.trigger("show-loading"),feedit.showMainTitleLoadingIndicator(),o=!0,t.trigger("get-content",[function(i){if("object"==typeof i&&void 0===i.error){var o=[],l=0;for(var s of(void 0===d||null==d||d.first_load||o.push(`\n          <ion-item id="prev_page" button color="primary" class="ion-text-center" lines="none" onclick="feedit.prevPage()">\n            <ion-label>\n              &laquo; ${window.lang.previous_page}\n            </ion-label>\n          </ion-item>\n          <ion-item id="prev_page_divider" lines="none"></ion-item>`),i))l++,o.push(feedit.returnItemTemplate(s));if(void 0!==d&&null!=d&&"down"==d.way&&l?a++:void 0!==d&&null!=d&&"up"==d.way&&l?a--:void 0!==d&&null!=d&&d.way||(a=1),l)e("#main ion-content ion-item-sliding, #prev_page, #prev_page_divider, #next_page, #next_page_divider").remove(),l==e("#filter_per_page").val()&&o.push(`\n          <ion-item id="next_page_divider" lines="none"></ion-item>\n          <ion-item id="next_page" button color="primary" class="ion-text-center" lines="none" onclick="feedit.nextPage()">\n            <ion-label>\n              ${window.lang.next_page} &raquo;\n            </ion-label>\n          </ion-item>`),e("#no_articles").after(o.join(""));else if(void 0===d||null==d||d.first_load){e("#main ion-content ion-item-sliding, #prev_page, #prev_page_divider, #next_page, #next_page_divider").remove();var r=e("#filter_status");e("#current_show_filter_value").text(r.find('ion-select-option[value="'+r.val()+'"]').html());var c=e("#filter_labels"),g=c.val();e("#number_labels_selected").text(g.length),e("#labels_filtered_by").html((g.length?" (<strong>":"")+c.find("ion-select-option").filter((function(){return g.indexOf(e(this).val())>-1})).map((function(){return e(this).text()})).toArray().join(", ")+(g.length?"</strong>)":"")),e("#no_articles").removeClass("ion-hide"),feedit.resetSelectedItemsCache(),e("#multiselect_actions").addClass("ion-hide"),feedit.untickSelectAllCheckbox()}else"up"==d.way?e("#prev_page, #prev_page_divider").remove():e("#next_page, #next_page_divider").remove()}else"object"==typeof i&&void 0!==i.error&&(e("#no_articles, #feed_error_info").removeClass("ion-hide"),e("#last_feed_error").text(i.error));t.trigger("item-select",["content_refresh"]),t.trigger("toggle-swipable-training-items"),t.trigger("refresh-link-counts",[{what:"all"},feedit.refreshMainTitle]),feedit.cache_labels(feedit.getActiveFeedId()),feedit.show_hide_cleanup_icon(),setTimeout((function(){t.trigger("toggle-swipable-training-items")}),2500),"function"==typeof n&&n(i)},l,function(){e(".feeds ion-spinner, #feed_cleanup_icon").addClass("ion-hide"),feedit.hideMainTitleLoadingIndicator(),void 0!==r&&void 0!==r["no-loading"]&&r["no-loading"]||t.trigger("hide-loading"),o=!1,"function"==typeof s&&s()},d]))})),t.on("get-content",(function(i,n,t,o,a){var l=feedit.getBasePaginationData();l.feed&&(void 0!==a&&null!=a&&e.extend(l,a),feedit.callAPI("api/content.php",l,(function(e){"function"==typeof n?n(e):console.log("Invalid success callback (not a function) passed to the get-content event: ",n)}),t,o))})),t.on("click",".bookmark",(function(){var i=e(this),n=i.find("ion-icon"),o="warning"==n.attr("color"),a={id:i.closest("ion-item").data("id")};i.attr("title",o?window.lang.bookmark_article:window.lang.remove_from_bookmarks),n.attr("name",o?"star-outline":"star"),o?(n.removeAttr("color"),a.action=0):(n.attr("color","warning"),a.action=1),feedit.callAPI("api/bookmark.php",a,(function(e){""==!e&&(i.attr("title",o?window.lang.remove_from_bookmarks:window.lang.bookmark_article),n.attr("name",o?"star":"star-outline"),o?n.attr("color","warning"):n.removeAttr("color"),feedit.presentToast({txt:window.lang.bookmarking_failed,duration:2e4}))}),(function(){i.attr("title",o?window.lang.remove_from_bookmarks:window.lang.bookmark_article),n.attr("name",o?"star":"star-outline"),o?n.attr("color","warning"):n.removeAttr("color")})),l>-1&&clearTimeout(l),l=setTimeout((function(){t.trigger("refresh-link-counts",[{what:"bookmarks"}]),l=-1}),5e3)})),t.on("click","#add_new_feed_intro_button",(function(){e(".add_new_feed_link").click(),e(".feeds").hasClass("ion-hide")&&e(".feeds_main_item").click()})),t.on("click",".link_image",(function(i){var n=e(this).find("img"),t=n.attr("src"),o=n.attr("data-hidden-img"),a=feedit.getActiveFeedItem().find("ion-label h3 img").attr("src");o?(n.attr("src",o),n.removeAttr("data-hidden-img"),t==o&&feedit.presentToast({txt:window.lang.article_no_img})):t!=a&&window.open(t,"_blank")})),t.on("mouseup","ion-item-sliding",(function(i){if(!(i.target.className.indexOf("anchor")>-1||i.target.className.indexOf("avatar_img")>-1||"ION-BADGE"==i.target.tagName||"ION-ICON"==i.target.tagName||"ION-AVATAR"==i.target.tagName||"SMALL"==i.target.tagName)){var n,t=(n="ION-TEXT"==this.tagName||this.className.indexOf("feed_body")>-1?e(this):"ION-ITEM-SLIDING"==this.tagName?e(this).find(".feed_body"):e(this).closest("ion-item").find(".feed_body")).closest("ion-item");t.parent("ion-item-sliding").hasClass("item-sliding-active-slide")||setTimeout((function(){t.hasClass("highlight_action_occured")||(n.toggleClass("ion-text-wrap"),n.hasClass("ion-text-wrap")&&n.find(".description_with_tags img").each((function(){var i=e(this);i.attr("src",i.data("src"))})),n.find("ion-text").toggleClass("ion-hide"))}),150)}})),t.on("click",".description_with_tags a",(function(){return window.open(e(this).attr("href"),"_blank"),!1})),e.extend(feedit,{getBasePaginationData(){var i=e("#filter_labels").val();return"string"==typeof i&&i.indexOf("[")>-1&&(i=i.replace("[","").replace("]","").split(","),e("#filter_labels").val(i)),{feed:feedit.getActiveFeedId(),status:e("#filter_status").val(),sort:e("#filter_sort").val(),hide:e("#filter_hiding").val(),per_page:e("#filter_per_page").val(),labels:i}},returnItemTemplate(i){var t=[],o=e("#main_menu .feeds ion-item.active ion-label h3 img").attr("src"),a=feedit.getActiveFeedItem().data("id"),l=void 0!==Cookies.get("show-images-"+a)&&1==Cookies.get("show-images-"+a),s=void 0!==Cookies.get("show-images-"+a)?l:void 0===Cookies.get("show-images")||1==Cookies.get("show-images"),d=!s&&feedit.isSimpleMode();t.push("\n          <ion-item-sliding"+(feedit.getSelectedItemsCache()[i._id]?' class="child_highlighted"':"")+`>\n            <ion-item-options side="start">\n              <ion-item-option color="danger" expandable>\n                <ion-icon name="close-sharp" class="ion-float-left"></ion-icon>\n                &nbsp; ${window.lang.Dislike}\n              </ion-item-option>\n            </ion-item-options>\n  \n            <ion-item class="link ion-color`+(void 0!==i.rated&&""!==i.rated?" item_is_trained":"")+(feedit.getSelectedItemsCache()[i._id]?" selected_item":"")+`" data-id="${i._id}" data-sc="${i.score_conformed}" data-date="${i.date_stamp}">\n              <ion-avatar slot="start" class="link_image `+(d?"ion-hide ":"")+(i.date.indexOf(", ")>-1?"date_multiline":"")+(feedit.isSimpleMode()?" v_center":"")+'">\n                <img class="avatar_img" src="'+(i.img&&(l||s)?i.img:o||"img/logo114.png")+'" '+(s||l?"":' data-hidden-img="'+(i.img?i.img:o||"img/logo114.png")+'"')+'>\n  \n                <ion-badge color="light" class="link_datetime'+(i.date.indexOf(", ")>-1?" link_datetime_long":"")+(feedit.isSimpleMode()?" ion-hide":"")+`" title="${i.date_long}">\n                  <small>${i.date}</small>\n                </ion-badge>\n              </ion-avatar>\n              <ion-label>\n                <h2 class="ion-text-wrap`+(i.read?"":" unread")+`">\n                  <a href="${i.link}" target="_blank" class="item_link"><span class="anchor">${i.title}</span></a>\n                </h2>\n  \n                <h2 class="feed_body">\n                  <ion-text class="description_tagless">${i.description_clear}</ion-text>\n                  <ion-text class="description_with_tags ion-hide">${i.description}</ion-text>\n                </h2>\n  \n                <p class="actions ion-text-wrap">\n                  <ion-badge color="light" class="bookmark right5px simple-mode-ignore" title="`+(i.bookmarked?window.lang.remove_from_bookmarks:window.lang.bookmark_article)+'">\n                    <ion-icon name="star'+(i.bookmarked?"":"-outline")+'"'+(i.bookmarked?' color="warning"':"")+"></ion-icon>\n                  </ion-badge>"),i.label_predictions&&t.push(function(e){var i=[];for(var n of e)i.push("\n            <ion-badge "+(n.trust?'color="dark"':'style="background-color: #5E5E5E"')+` class="label_badge prediction" data-id="${n.id}" title="${window.lang.label_temporary}">\n              <small>${n.label}*</small>\n            </ion-badge>`);return i.join("")}(i.label_predictions)),i.labels&&t.push(feedit.getLabelsHTML(i.labels));var r="";if(feedit.isSimpleMode()?"bookmarks"!=a&&"all"!=a?r+="ion-hide":"bookmarks"!=a&&"all"!=a||(r+="simple-mode-ignore"):n.hasClass("ion-hide")?r+="ion-hide simple-mode-ignore":"bookmarks"!=a&&"all"!=a||(r+="simple-mode-ignore"),t.push('\n  \n                  <ion-badge color="success" class="ion-hide-xl-down train_up'+(feedit.isSimpleMode()?(void 0===i.rated||1==i.rated||""===i.rated?" shown-outside-simple-mode":"")+" ion-hide":void 0===i.rated||1==i.rated||""===i.rated?"":" ion-hide")+'">\n                    <ion-icon name="checkmark-sharp"></ion-icon>\n                  </ion-badge>\n                  <ion-badge color="danger" class="ion-hide-xl-down train_down'+(feedit.isSimpleMode()?(void 0===i.rated||0==i.rated||""===i.rated?" shown-outside-simple-mode":"")+" ion-hide":void 0===i.rated||0==i.rated||""===i.rated?"":" ion-hide")+'">\n                    <ion-icon name="close-sharp"></ion-icon>\n                  </ion-badge>\n  \n                  <ion-badge class="train'+(feedit.isSimpleMode()?" ion-hide":"")+`">\n                     <ion-icon name="bar-chart-sharp" class="ion-float-left"></ion-icon>\n                    &nbsp;<ion-text><small>${window.lang.train}</small></ion-text>\n                  </ion-badge>\n\n                  <ion-badge class="labels ${r}" color="`+("bookmarks"==a||"all"==a?"light":"dark")+`">\n                     <ion-icon name="pricetag-outline" class="ion-float-left"></ion-icon>\n                    &nbsp;<ion-text><small>${window.lang.labels}</small></ion-text>\n                  </ion-badge>\n\n                  \x3c!--  up/down result badge after the item has been swipe-trained //--\x3e\n                  <ion-badge color="success" class="`+(feedit.isSimpleMode()?"":"ion-hide-xl-up ")+"trained_up"+(void 0!==i.rated&&1==i.rated?"":" ion-hide")+'">\n                    <ion-icon name="checkmark-sharp"></ion-icon>\n                  </ion-badge>\n                  <ion-badge color="danger" class="'+(feedit.isSimpleMode()?"":"ion-hide-xl-up ")+"trained_down"+(void 0!==i.rated&&0==i.rated&&""!==i.rated?"":" ion-hide")+'">\n                    <ion-icon name="close-sharp"></ion-icon>\n                  </ion-badge>'),void 0!==i.feed){var c=e(".feeds ion-item[data-id="+i.feed+"] ion-label h3 span"),g=c.text(),m=c.prev("img").attr("src");t.push(`\n                    <ion-badge color="light" class="feed_name_badge simple-mode-ignore">\n                      <img src="${m}" class="right5px" /><small>${g}</small>\n                    </ion-badge>`)}return t.push(`\n                </p>\n              </ion-label>\n            </ion-item>\n  \n            <ion-item-options side="end">\n              <ion-item-option color="success" expandable>\n                ${window.lang.Like}&nbsp;\n                <ion-icon name="checkmark-sharp" class="ion-float-left"></ion-icon>\n              </ion-item-option>\n            </ion-item-options>\n          </ion-item-sliding>`),t.join("")},getNextPageSortData(n){if("date"==i.val()){var t=e("#main ion-content ion-item-sliding ion-item").last().data("date"),o=(s=feedit.getSkipLimitPaginationData("date",t)).use_skip_limit,l=s.exclude_ids;n.use_skip_limit=o,n.date=t,n.exclude_ids=l,n.page=a}else{var s,d=e("#main ion-content ion-item-sliding ion-item").last().data("sc");o=(s=feedit.getSkipLimitPaginationData("sc",d)).use_skip_limit,l=s.exclude_ids,n.use_skip_limit=o,n.sc=d,n.exclude_ids=l,n.page=a}return n},nextPage(){t.trigger("refresh-content",[null,null,null,e("#next_page").hasClass("force_reload")?null:feedit.getNextPageSortData({way:"down"})])},getPrevPageSortData(n){if("date"==i.val()){var t=e("#main ion-content ion-item-sliding ion-item").first().data("date"),o=(s=feedit.getSkipLimitPaginationData("date",t)).use_skip_limit,l=s.exclude_ids;n.use_skip_limit=o,n.date=t,n.exclude_ids=l,n.page=a}else{var s,d=e("#main ion-content ion-item-sliding ion-item").first().data("sc");o=(s=feedit.getSkipLimitPaginationData("sc",d)).use_skip_limit,l=s.exclude_ids,n.use_skip_limit=o,n.sc=d,n.exclude_ids=l,n.page=a}return n},prevPage(){t.trigger("refresh-content",[null,null,null,e("#prev_page").hasClass("force_reload")?null:feedit.getPrevPageSortData({way:"up"})])},getCurrentPage:()=>a,getSkipLimitPaginationData(i,n){var t=e("#main ion-content ion-item-sliding"),o=0,a=[],l=t.find("[data-"+i+'="'+n+'"]');return l.length==t.length?o=1:a=l.map((function(){return e(this).data("id")})).toArray(),{use_skip_limit:o,exclude_ids:a}},instaFetchFeed(e){feedit.presentToast({txt:window.lang.available_soon,duration:2500}),console.log("insta-fetch of feed "+e+" requested")},getLabelsHTML(e){var i=[];for(var n of e)i.push(`\n                <ion-badge color="dark" class="label_badge" data-id="${n.id}">\n                  <small>${n.label}</small>\n                </ion-badge>`);return i.join("")},showMainTitleLoadingIndicator(){e("#feed_cleanup_icon").hasClass("ion-hide")||e("#feed_cleanup_icon").addClass("ion-hide re-show-after-load"),e("#feed_load_main_title_indicator").length||e("#active_feed_title_header > span").prepend('<ion-spinner name="lines-small" class="right5px ion-float-left" id="feed_load_main_title_indicator"></ion-spinner>')},hideMainTitleLoadingIndicator(){e("#feed_load_main_title_indicator").remove(),e("#feed_cleanup_icon").hasClass("re-show-after-load")&&e("#feed_cleanup_icon").removeClass("re-show-after-load ion-hide")},refreshMainTitle(){"0"!=feedit.getActiveFeedItem().find(".links_counter ion-badge").text()?e("#active_feed_title_header .feed_title_and_count").text("("+feedit.getActiveFeedItem().find(".links_counter ion-badge").text()+") "+feedit.getActiveFeedItem().find("ion-label h3 span").text()):e("#active_feed_title_header .feed_title_and_count").text(feedit.getActiveFeedItem().find("ion-label h3 span").text())}})}))}(jQuery),function(e){var i,n=e(document),t=!1,o=!1,a=!1,l=-1,s=null,d={},r=!1;async function c(i){a=!1,n.trigger("open-modal",[await modalController.create({component:"modal-add-feed",componentProps:{langs:i}}),function(){setTimeout((function(){e("#feed_url")[0].setFocus()}),500)}])}async function g(i,t){n.trigger("open-modal",[await modalController.create({component:"modal-update-feed",componentProps:{langs:t,lang:i.data("lang"),id:i.data("id"),url:i.data("url"),title:i.find("ion-label h3 span").text(),allow_duplicates:i.data("allow-duplicates")}}),function(){setTimeout((function(){e("#feed_title")[0].setFocus()}),500)}])}function m(){var i=!0,n=!0,t=e("#feed_title").length;e("#feed_title").length?i=""!=e("#feed_title").val():n=""!=e("#feed_url").val(),n&&e("#feed_lang").val()&&i?e("#"+(t?"edit_feed":"add_selected_feeds")).removeAttr("disabled"):e("#"+(t?"edit_feed":"add_selected_feeds")).attr("disabled","disabled")}n.on("app-init",(function(){i=e("#feeds_sort"),setTimeout((function(){s=feedit.getActiveFeedId()}),1e3),setInterval((function(){n.trigger("refresh-link-counts",[{what:"all"}])}),3e5),customElements.define("modal-update-feed",class extends HTMLElement{connectedCallback(){var e=[];for(var i in e.push(`\n  <ion-header>\n    <ion-toolbar>\n      <ion-title>${window.lang.edit_feed}</ion-title>\n      <ion-buttons slot="primary">\n        <ion-button onClick="feedit.showHelp($(this).find('ion-icon')[0], 'edit-feed')">\n          <ion-icon slot="icon-only" name="information-circle-outline" title="${window.lang.how_to_edit_a_feed}"></ion-icon>\n        </ion-button>\n        <ion-button onClick="feedit.dismissModal()">\n          <ion-icon slot="icon-only" name="close"></ion-icon>\n        </ion-button>\n      </ion-buttons>\n    </ion-toolbar>\n  </ion-header>\n  <ion-content class="ion-padding">\n    <ion-label><strong>${window.lang.feeds_url}</strong>:</ion-label>\n    <ion-text class="bottom10px">`+feedit.getTopModal().componentProps.url+`</ion-text>\n\n    <br><br><br>\n  \n    <ion-label><strong>${window.lang.feed_title}</strong> <small>(${window.lang.required})</small>:</ion-label>\n    <ion-input id="feed_title" value="`+feedit.getTopModal().componentProps.title+`" class="bottom10px"></ion-input>\n\n    <br>\n    <ion-label><strong>${window.lang.feed_lang}</strong> <small>(${window.lang.required})</small>:</ion-label>\n    <ion-select id="feed_lang" value="`+feedit.getTopModal().componentProps.lang+`" cancel-text="${window.lang.cancel}" ok-text="${window.lang.confirm}">`),feedit.getTopModal().componentProps.langs){var n=feedit.getTopModal().componentProps.langs[i];e.push('<ion-select-option value="'+n.code+'">'+n.name_en+(n.name?" ("+n.name+")":"")+"</ion-select-option>")}e.push(`\n    </ion-select>\n\n    <br>\n    <ion-item class="ion-no-padding">\n      <ion-icon slot="start" name="information-circle-outline" class="ion-no-margin right10px" title="${window.lang.what_is_allow_duplicate_articles}?" onclick="feedit.showHelp(this, 'allow-duplicates')"></ion-icon>\n      <ion-checkbox slot="end" id="allow_duplicates"`+(feedit.getTopModal().componentProps.allow_duplicates?' checked="true"':"")+`></ion-checkbox>\n      <ion-label><strong>${window.lang.allow_duplicate_articles}</strong></ion-label>\n    </ion-item>\n\n    <br>\n\n    <div class="ion-float-right top10px">\n      <a href="javascript:feedit.dismissModal()" class="ion-margin">${window.lang.cancel}</a>\n      <ion-button color="primary" id="edit_feed" data-feed-id="`+feedit.getTopModal().componentProps.id+`" disabled>${window.lang.confirm}</ion-button>\n    </div>\n  </ion-content>\n    `),this.innerHTML=e.join("")}}),customElements.define("modal-add-feed",class extends HTMLElement{connectedCallback(){var e=[];for(var i in e.push(`\n  <ion-header>\n    <ion-toolbar>\n      <ion-title>${window.lang.add_new_feed}</ion-title>\n      <ion-buttons slot="primary">\n        <ion-button onClick="feedit.showHelp($(this).find('ion-icon')[0], 'add-feed')">\n          <ion-icon slot="icon-only" name="information-circle-outline" title="${window.lang.how_to_add_a_feed}"></ion-icon>\n        </ion-button>\n        <ion-button onClick="feedit.dismissModal()">\n          <ion-icon slot="icon-only" name="close"></ion-icon>\n        </ion-button>\n      </ion-buttons>\n    </ion-toolbar>\n  </ion-header>\n  <ion-content class="ion-padding">\n    <ion-label><strong>${window.lang.feeds_url}</strong> <small>(${window.lang.required})</small>:</ion-label>\n    <ion-input id="feed_url" placeholder="https://" class="bottom10px"></ion-input>\n\n    <br>\n    <ion-label><strong>${window.lang.feed_lang}</strong> <small>(${window.lang.required})</small>:</ion-label>\n    <ion-select id="feed_lang" placeholder="${window.lang.select_feed_lang}" cancel-text="${window.lang.cancel}" ok-text="${window.lang.confirm}">`),feedit.getTopModal().componentProps.langs){var n=feedit.getTopModal().componentProps.langs[i];e.push('<ion-select-option value="'+n.code+'">'+n.name_en+(n.name?" ("+n.name+")":"")+"</ion-select-option>")}e.push(`\n    </ion-select>\n\n    <br>\n    <ion-item class="ion-no-padding">\n      <ion-icon slot="start" name="information-circle-outline" class="ion-no-margin right10px" title="${window.lang.what_is_allow_duplicate_articles}?" onclick="feedit.showHelp(this, 'allow-duplicates')"></ion-icon>\n      <ion-checkbox slot="end" id="allow_duplicates"></ion-checkbox>\n      <ion-label><strong>${window.lang.allow_duplicate_articles}</strong></ion-label>\n    </ion-item>\n\n    <br>\n    <ion-item class="ion-no-padding">\n      <ion-icon slot="start" name="information-circle-outline" class="ion-no-margin right10px" title="${window.lang.what_is_manual_prioritization}?" onclick="feedit.showHelp(this, 'manual-priorities')"></ion-icon>\n      <ion-checkbox slot="end" id="use_manual_priorities"></ion-checkbox>\n      <ion-label><strong>${window.lang.use_manual_priority}</strong></ion-label>\n    </ion-item>\n\n    <br>\n    <ion-reorder-group id="manual_reorder_group" class="ion-hide">\n      <ion-item>\n        <ion-label>${window.lang.words}</ion-label>\n        <ion-reorder slot="end"></ion-reorder>\n      </ion-item>\n      <ion-item>\n        <ion-label>${window.lang.numbers}</ion-label>\n        <ion-reorder slot="end"></ion-reorder>\n      </ion-item>\n      <ion-item>\n        <ion-label>${window.lang.measurement_units}</ion-label>\n        <ion-reorder slot="end"></ion-reorder>\n      </ion-item>\n    </ion-reorder-group>\n\n    <br>\n    <br>\n    <ion-list id="feeds_found">\n      <ion-list-header>\n        <h4>${window.lang.feeds_found}: <ion-spinner name="lines-small" class="ion-hide"></ion-spinner></h4>\n      </ion-list-header>\n    </ion-list>\n\n    <br>\n\n    <div class="ion-float-right top10px">\n      <a href="javascript:feedit.dismissModal()" class="ion-margin">${window.lang.cancel}</a>\n      <ion-button color="primary" id="add_selected_feeds" disabled>${window.lang.confirm}</ion-button>\n    </div>\n  </ion-content>\n    `),this.innerHTML=e.join("")}}),n.on("ionItemReorder",(function(e){e.originalEvent.detail.complete()})),n.on("ionChange","#use_manual_priorities",(function(i){e("#manual_reorder_group").toggleClass("ion-hide").get(0).disabled=!i.originalEvent.detail.checked})),n.on("ionChange",m),n.on("click",".feed_actions_grid ion-col",(function(){e(".feeds ."+this.id.replace("_btn","_link")).click()})),n.on("click",".feeds ion-item",(function(i){var o,a=e(this);if(a.hasClass("divider"))return!0;if(3==i.which)return!0;if(a.hasClass("add_new_feed_link"))return t||(t=!0,n.trigger("show-loading"),Object.keys(d).length?(c(d),t=!1):feedit.callAPI("api/languages.php",null,(function(e){"object"==typeof e?(d=e,c(e)):feedit.defaultErrorNotification()}),null,(function(){n.trigger("hide-loading"),t=!1}))),!0;if(a.hasClass("reload_feeds_link"))return n.trigger("refresh-left-menu-feeds",[null,{"no-content-update":1}]),!0;if(a.hasClass("show_images_link")){var l=1,g=feedit.getActiveFeedItem().data("id");return void 0!==Cookies.get("show-images-"+g)?(l=0==Cookies.get("show-images-"+g)?1:0,Cookies.set("show-images-"+g,l,{expires:365})):void 0!==Cookies.get("show-images")?(l=0==Cookies.get("show-images")?1:0,Cookies.set("show-images",l,{expires:365}),Cookies.set("show-images-"+g,l,{expires:365})):(l=0,Cookies.set("show-images",0,{expires:365}),Cookies.set("show-images-"+g,0,{expires:365})),l?(e("#main .link_image img[data-hidden-img]").each((function(){var i=e(this);i.attr("src",i.attr("data-hidden-img")).removeAttr("data-hidden-img")})),e("#main ion-item ion-avatar").removeClass("ion-hide"),e("#show_images_icon").attr("color","success")):(e("#main .link_image img").each((function(){var i=e(this);i.attr({"data-hidden-img":i.attr("src"),src:"all"!=g&&"bookmarks"!=g?feedit.getActiveFeedItem().find("ion-label h3 img").attr("src"):"img/logo114.png"})})),feedit.isSimpleMode()&&e("#main ion-item ion-avatar").addClass("ion-hide"),e("#show_images_icon").attr("color","dark")),!0}return!(!a.hasClass("remove_feed_item")&&!a.hasClass("feeds_sort_select"))||((o=a.find('ion-icon[name="trash-bin"]'))&&o.length&&!o.hasClass("ion-hide")&&!r?(feedit.presentRemoveFeedDialog(a),!0):("star"==o.attr("name")&&feedit.presentToast({txt:window.lang.bookmarks_cannot_be_removed}),r=!1,void(a.hasClass("longpressed")?a.removeClass("longpressed"):(a.hasClass("active")||(e(".feeds ion-item").removeClass("active"),a.addClass("active"),Cookies.set("feed-active",a.data("id"),{expires:365})),feedit.refreshMainTitle(),e("#feed_cleanup_icon").addClass("ion-hide"),a.find("ion-spinner").removeClass("ion-hide"),e("#feed_load_main_title_indicator").remove(),Cookies.get("filter_sort-"+a.data("id"))&&e("#filter_sort").val()!=Cookies.get("filter_sort-"+a.data("id"))&&e("#filter_sort").addClass("no_content_change").val(Cookies.get("filter_sort-"+a.data("id"))),Cookies.get("filter_status-"+a.data("id"))&&e("#filter_status").val()!=Cookies.get("filter_status-"+a.data("id"))&&e("#filter_status").addClass("no_content_change").val(Cookies.get("filter_status-"+a.data("id"))),Cookies.get("filter_hiding-"+a.data("id"))&&e("#filter_hiding").val()!=Cookies.get("filter_hiding-"+a.data("id"))&&e("#filter_hiding").addClass("no_content_change").val(Cookies.get("filter_hiding-"+a.data("id"))),Cookies.get("filter_per_page-"+a.data("id"))&&e("#filter_per_page").val()!=Cookies.get("filter_per_page-"+a.data("id"))&&e("#filter_per_page").addClass("no_content_change").val(Cookies.get("filter_per_page-"+a.data("id"))),feedit.resetSelectedItemsCache(),n.trigger("item-select",[{origin:"content_refresh"}]),s!=feedit.getActiveFeedId()&&(e("#filter_labels").val(""),Cookies.remove("filter_labels"),s=feedit.getActiveFeedId()),feedit.updateShowImagesIcon(),n.trigger("refresh-content",[null,null,null,null,{"no-loading":!0}])))))})),n.on("click","#add_selected_feeds",(function(){var i={feeds:e("#feeds_found ion-checkbox.checkbox-checked").map((function(i,n){return{title:e(this).prev("ion-label").find("strong").text(),url:n.value}})).toArray(),feed_lang:e("#feed_lang").val(),feed_url:e("#feed_url").val(),allow_duplicates:e("#allow_duplicates")[0].checked,manual_priorities:e("#use_manual_priorities")[0].checked};i.manual_priorities&&(i.priorities=e("#manual_reorder_group ion-label").map((function(){return e(this).html()})).toArray()),n.trigger("show-loading"),feedit.callAPI("api/feed_add.php",i,(function(e){"object"==typeof e?(n.trigger("left-menu-feeds-add",[e]),feedit.dismissModal()):feedit.defaultErrorNotification()}),(function(){n.trigger("refresh-left-menu-feeds")}),(function(){n.trigger("hide-loading")}))})),n.on("click","#edit_feed",(function(){var i=e(this),t={feed:i.data("feed-id"),feed_lang:e("#feed_lang").val(),feed_title:e("#feed_title").val(),allow_duplicates:e("#allow_duplicates")[0].checked};n.trigger("show-loading"),feedit.callAPI("api/feed_edit.php",t,(function(n){""==n?(e('.feeds ion-item[data-id="'+t.feed+'"]').data({lang:t.feed_lang,"allow-duplicates":e("#allow_duplicates")[0].checked?1:0}).attr({"data-lang":t.feed_lang,"data-allow-duplicates":e("#allow_duplicates")[0].checked?1:0,title:t.feed_title}).find("ion-label h3 span").text(t.feed_title),feedit.getActiveFeedId()==i.data("feed-id")&&feedit.refreshMainTitle(),feedit.dismissModal(),feedit.presentToast({txt:window.lang.feed_updated,duration:1e3})):feedit.defaultErrorNotification()}),null,(function(){n.trigger("hide-loading")}))})),n.on("click","#remove_feeds",(function(){e(this).closest("ion-list").find('ion-icon[name="trash-bin"], .links_counter').toggleClass("ion-hide")})),n.on("refresh-link-counts",(function(i,t,o){e.extend(t,feedit.getBasePaginationData()),feedit.callAPI("api/feeds_counts.php",t,(function(i){"object"==typeof i&&(n.trigger("update-feeds-counts",[i]),e("#no_articles").hasClass("ion-hide")||"0"==feedit.getActiveFeedItem().find(".links_counter ion-badge").text()||"bookmarks"==feedit.getActiveFeedItem().data("id")||e("#filter_labels").val().length||n.trigger("refresh-content",[null,null,null,{first_load:!0}]),"function"==typeof o&&o())}),!1)})),n.on("refresh-left-menu-feeds",(function(t,a,l){if(!o){n.trigger("show-loading"),o=!0;var s=feedit.getBasePaginationData();s.feeds_sort=i.val(),feedit.callAPI("api/feeds.php",s,(function(i){"object"==typeof i?(void 0!==i.bookmarks_count&&(e(".bookmarks_item .links_counter ion-badge").text(i.bookmarks_count),delete i.bookmarks_count),void 0!==i.all_count&&(e(".all_feeds_item .links_counter ion-badge").text(i.all_count),delete i.all_count),void 0!==i.low_negatives_warning&&(feedit.presentToast({txt:window.lang.negative_training_warning,duration:3e4}),Cookies.set("training_check_warning_displayed",1,{expires:365}),delete i.low_negatives_warning),n.trigger("left-menu-feeds-update",[i,a])):feedit.defaultErrorNotification()}),null,(function(){o=!1,void 0!==l&&l["no-content-update"]&&1==l["no-content-update"]?n.trigger("hide-loading"):n.trigger("refresh-content",[null,null,null,{first_load:!0}])}))}})),n.on("ionChange","#feeds_sort",(function(){Cookies.set("feeds_sort",i.val(),{expires:365}),n.trigger("refresh-left-menu-feeds")})),n.on("ionChange","#feed_lang",(function(){a=!0})),n.on("ionChange","#feed_url",(function(i){e("#feed_title").length||(l>-1&&clearTimeout(l),l=setTimeout((function(){!1!==o&&(o.abort(),o=!1),e("#feeds_found ion-item").remove(),e("#feeds_found ion-spinner").removeClass("ion-hide"),o=feedit.callAPI("api/feeds_discovery.php",{url:i.originalEvent.detail.value},(function(i){if("object"==typeof i&&void 0!==i.items){if(void 0!==i.lang&&!a)for(var n in d)if(d[n].code==i.lang){e("#feed_lang").val(i.lang),a=!1;break}var t=[];for(var n in i.items){var o=i.items[n];t.push(`\n      <ion-item>\n        <ion-avatar slot="start"><img src="${i.icon}" /></ion-avatar>\n        <ion-label><strong>${o.title}</strong><br>${o.url}</ion-label>\n        <ion-checkbox slot="end" value="${o.url}"></ion-checkbox>\n      </ion-item>\n                `)}e("#feeds_found ion-list-header").after(t.join(""))}else feedit.defaultErrorNotification()}),null,(function(){o=!1,l=-1,e("#feeds_found ion-spinner").addClass("ion-hide")}))}),1500))})),n.on("click","#feed_cleanup_icon",(function(){e("#main ion-item-sliding ion-item").each((function(){var i=e(this);!i.hasClass("item_is_trained")&&i.find("h2").first().hasClass("unread")||feedit.hide_single_item(e(this))})),e(this).addClass("ion-hide")})),setTimeout((function(){n.trigger("refresh-left-menu-feeds",[function(){setTimeout((function(){feedit.getActiveFeedItem().length?feedit.refreshMainTitle():setTimeout((function(){e(".all_feeds_item").click()}),500),e("#feed_cleanup_icon").addClass("ion-hide"),feedit.updateShowImagesIcon()}),250)}])}),1e3),e.extend(feedit,{toggleFeedsMenuItem(i){var n=e(i),t=n.find('ion-icon[slot="end"]');t.length&&(n.siblings(".feed_actions_grid, .feeds").toggleClass("ion-hide"),t.attr("name").indexOf("-down")>-1?(t.attr("name","chevron-forward-outline"),Cookies.set("feeds-menu-open",!1,{expires:365})):(t.attr("name","chevron-down-outline"),Cookies.set("feeds-menu-open",!0,{expires:365})))},presentRemoveFeedDialog(i){"string"==typeof i&&(i=e('.feed_item[data-id="'+i+'"]'));var t=document.createElement("ion-alert");t.header=window.lang.remove_feed,t.message=window.lang.remove_feed_question+" <strong>"+i.find("ion-label h3 span").text()+" ("+i.data("url")+")</strong>?",t.buttons=[{text:window.lang.cancel,role:"cancel",cssClass:"secondary"},{text:window.lang.confirm,handler:()=>{i.find("ion-spinner").hasClass("ion-hide")&&(i.find("ion-spinner").removeClass("ion-hide"),feedit.callAPI("api/feed_remove.php",{id:i.data("id")},(function(t){""==t?setTimeout((function(){i.css({transition:"0.35s ease-out",transform:"translate3d("+(i.width()+10)+"px, 0, 0)"}),setTimeout((function(){if(i.hasClass("active")){var t=i.prev(".feed_item");t.length||(t=i.next(".feed_item")),t.length||(t=e(".all_feeds_item"),e(".labels_management").addClass("ion-hide")),r=!0,t.click()}else"bookmarks"!=feedit.getActiveFeedId()&&"all"!=feedit.getActiveFeedId()||n.trigger("refresh-content");feedit.presentToast({txt:window.lang.feed_removed,short:!0}),n.trigger("refresh-link-counts",[{what:"all"}]),i.remove()}),340)}),1e3):feedit.defaultErrorNotification()}),null,(function(){i.find("ion-spinner").addClass("ion-hide")})))}}],document.body.appendChild(t),t.present()},presentUpdateFeedDialog(i){"string"==typeof i&&(i=e('.feed_item[data-id="'+i+'"]')),n.trigger("show-loading"),Object.keys(d).length?g(i,d):feedit.callAPI("api/languages.php",null,(function(e){"object"==typeof e?(d=e,g(i,e)):feedit.defaultErrorNotification()}),null,(function(){n.trigger("hide-loading")}))},getActiveFeedItem:()=>e(".feeds ion-item.active"),getActiveFeedId:()=>e(".feeds ion-item.active").data("id"),updateShowImagesIcon(){var i=feedit.getActiveFeedItem().data("id"),n=void 0!==Cookies.get("show-images-"+i)&&1==Cookies.get("show-images-"+i);(void 0!==Cookies.get("show-images-"+i)?n:void 0===Cookies.get("show-images")||1==Cookies.get("show-images"))?e("#show_images_icon").attr("color","success"):e("#show_images_icon").attr("color","dark")}})}))}(jQuery);var feedit=function(e){var i,n,t=e(document),o=e(window),a=!1,l=!1,s=!1,d=!1,r=!1,c={},g=!1;function m(){var i=['<ion-select id="languageSelect" interface="alert" cancel-text="'+window.lang.cancel+'" ok-text="'+window.lang.confirm+'" class="ion-no-padding ion-hide" value="'+window.lang_id+'">'];for(var n of c)i.push('<ion-select-option value="'+n.id+'">'+n.name+"</ion-select-option>");i.push("</ion-select>"),e("body").append(i.join("")),setTimeout((function(){var i=e("#languageSelect")[0];i.value=window.lang_id,i.interfaceOptions={header:window.lang.change_language},i.open().then((function(){t.trigger("hide-loading")}))}),100)}function f(){e("ion-title:visible").length?(l=!0,i=e("#session_id"),r=!!e("#simple_mode").prop("checked"),n=setInterval((function(){Cookies.get("feedit")!=i.val()&&(clearInterval(n),document.location.reload())}),1e3),customElements.define("modal-bugreport",class extends HTMLElement{connectedCallback(){var e=feedit.getLocalStorageValue("bugreport");null===e&&(e=""),this.innerHTML=`\n  <ion-header>\n    <ion-toolbar>\n      <ion-title>${window.lang.report_a_problem}</ion-title>\n      <ion-buttons slot="primary">\n        <ion-button onClick="feedit.dismissModal()">\n          <ion-icon slot="icon-only" name="close"></ion-icon>\n        </ion-button>\n      </ion-buttons>\n    </ion-toolbar>\n  </ion-header>\n  <ion-content class="ion-padding">\n    <ion-item>\n    <ion-label position="floating">${window.lang.problem_type}</ion-label>\n      <ion-select id="bug_type" value="bug">\n        <ion-select-option value="bug">${window.lang.technical_problem}</ion-select-option>\n        <ion-select-option value="acc">${window.lang.account_problem}</ion-select-option>\n      </ion-select>\n\n      <ion-label position="floating">${window.lang.problem_description}</ion-label>\n      <ion-textarea id="bug_report_text" rows="10" placeholder="${window.lang.describe_problem_in_steps}" value="${e}"></ion-textarea>\n    </ion-item>\n\n    <br>\n\n    <div class="ion-float-right top10px">\n      <a href="javascript:feedit.dismissModal()" class="ion-margin">${window.lang.cancel}</a>\n      <ion-button color="primary" id="send_bug_report">${window.lang.send}</ion-button>\n    </div>\n  </ion-content>`}}),t.on("click","#send_bug_report",(function(){t.trigger("show-loading"),feedit.callAPI("api/report_bug.php",{type:e("#bug_type").val(),msg:e("#bug_report_text").val()},(function(i){""==i?(feedit.dismissModal(),feedit.presentToast({txt:window.lang.problem_report_sent}),e("#bug_report_text").addClass("no-local-save")):feedit.defaultErrorNotification()}),null,(function(){t.trigger("hide-loading")}))})),o.on("resize",(function(){l&&t.trigger("toggle-swipable-training-items")})),t.on("desktop-sized-change",(function(e,i){a=i})),t.on("mouseup","ion-item-sliding",(function(e){document.activeElement.blur()})),t.on("ionChange","#simple_mode",(function(i){if(e("#main ion-item ion-badge").not(".label_badge, .train_up, .train_down, .trained_up, .trained_down, .simple-mode-ignore").toggleClass("ion-hide"),i.originalEvent.detail.checked){e("#main ion-item ion-badge.train_up, ion-item ion-badge.train_down").not(".ion-hide").addClass("shown-outside-simple-mode ion-hide"),e(".trained_up, .trained_down").removeClass("ion-hide-xl-up");var n=feedit.getActiveFeedItem().data("id");(void 0!==Cookies.get("show-images-"+n)&&0==Cookies.get("show-images-"+n)||void 0===Cookies.get("show-images-"+n)&&void 0!==Cookies.get("show-images")&&0==Cookies.get("show-images"))&&e("#main ion-item ion-avatar").addClass("ion-hide"),Cookies.set("simple-mode",!0,{expires:365}),r=!0,feedit.isDesktopSized()&&void 0===Cookies.get("first_simple_mode_message")&&(Cookies.set("first_simple_mode_message",1,{expires:365}),feedit.presentToast({txt:window.lang.simple_mode_controls_differ,duration:3e4,buttons:[{txt:window.lang.learn_more,callback:function(){e(".main_help_icon").click()}}]}))}else e("#main ion-item ion-badge.shown-outside-simple-mode, #main ion-item ion-avatar").removeClass("shown-outside-simple-mode ion-hide"),e(".trained_up, .trained_down").addClass("ion-hide-xl-up"),Cookies.set("simple-mode",!1,{expires:365}),r=!1;e("#main ion-item-sliding ion-avatar").toggleClass("v_center"),t.trigger("toggle-swipable-training-items")})),t.on("ionRefresh",(function(){feedit.resetSelectedItemsCache(),t.trigger("item-select",[{origin:"content_refresh"}]),t.trigger("refresh-content",[function(){e("#main ion-item-sliding ion-item").each((function(){feedit.getSelectedItemsCache()[e(this).data("id")]&&e(this).addClass("selected_item").find("ion-item-sliding").addClass("child_highlighted")}))},null,function(){e("ion-refresher")[0].complete()},null,{"no-loading":1}])})),t.on("mousedown touchstart",(function(){d=!0})),t.on("mouseup touchend touchcancel",(function(){d=!1})),t.on("ionChange","#languageSelect",(function(e){document.location.href=document.location.href.substring(0,document.location.href.indexOf("?lang="))+"?lang="+e.originalEvent.detail.value})),o.on("beforeunload",h),o.on("pagehide",h),o.on("visibilitychange",h),o.on("ionModalWillDismiss",h),t.trigger("app-init")):setTimeout(f,1e3)}function h(){var i=e("#bug_report_text");i.length&&i.val()&&!i.hasClass("no-local-save")?feedit.setLocalStorageValue("bugreport",e("#bug_report_text").val()):(feedit.removeLocalStorageValue("bugreport"),i.removeClass("no-local-save"))}return e((function(){f()})),{isDesktopSized:()=>a,setLocalStorageValue(e,i){try{localStorage.setItem(e,i)}catch(e){}},getLocalStorageValue(e){try{return localStorage.getItem(e)}catch(e){}},removeLocalStorageValue(e){try{localStorage.removeItem(e)}catch(e){}},isMouseDown:()=>d,getLongPressDelayTime:()=>500,getDoubleClickDelayTime:()=>350,isSimpleMode:()=>r,changeLanguage(){g||(g=!0,t.trigger("show-loading"),Object.keys(c).length?m():feedit.callAPI("api/langs.php",null,(function(e){"object"==typeof e?(c=e,m()):feedit.defaultErrorNotification()}),null,(function(){t.trigger("hide-loading"),g=!1})))},sendBugReport(){s||(s=!0,t.trigger("show-loading"),async function(){t.trigger("open-modal",[await modalController.create({component:"modal-bugreport"})]),s=!1}())},async presentToast(e){const i=document.createElement("ion-toast");if(i.message=e.txt,e.short?(i.duration=1e3,i.cssClass="ion-text-center"):i.duration="number"==typeof e.duration?e.duration:1500,e.buttons){var n=[];for(var t in e.buttons){var o={text:e.buttons[t].txt};"function"==typeof e.buttons[t].callback&&(o.handler=e.buttons[t].callback),n.push(o)}n.push({text:window.lang.ok,role:"cancel"}),i.buttons=n}else e.short||(i.buttons=[{text:window.lang.ok,role:"cancel"}]);return document.body.appendChild(i),i.present()}}}(jQuery);!function(e){var i=e(document),n=!1;i.on("app-init",(function(){customElements.define("modal-help",class extends HTMLElement{connectedCallback(){this.innerHTML="\n  <ion-header>\n    <ion-toolbar>\n      <ion-title>"+feedit.getTopModal().componentProps.page_title+'</ion-title>\n      <ion-buttons slot="primary">\n        <ion-button onClick="feedit.dismissModal()">\n          <ion-icon slot="icon-only" name="close"></ion-icon>\n        </ion-button>\n      </ion-buttons>\n    </ion-toolbar>\n  </ion-header>\n  <ion-content class="ion-padding" id="help_content">\n    <p class="ion-text-center top10px">\n      <ion-spinner name="lines"></ion-spinner>\n    </p>\n  </ion-content>',feedit.callAPI("api/help.php",feedit.getTopModal().componentProps,(function(i){e("#help_content").html(i)}),(function(i){var n=JSON.parse(i.responseText);e("#help_content").html(n.error.detail)}))}}),e.extend(feedit,{showHelp(e,t){n||(n=!0,i.trigger("show-loading"),async function(e,t){i.trigger("open-modal",[await modalController.create({component:"modal-help",componentProps:{ajaxURL:"help-ajax.php",page_title:e,topic:t,is_desktop:feedit.isDesktopSized(),simple_mode:feedit.isSimpleMode(),lang:window.lang_id}})]),n=!1}(e.title,t))},goToPageIndex(i){e("#help-slides")[0].slideTo(i)}})}))}(jQuery),function(e){var i,n=e(document);n.on("app-init",(function(){i=e("#select_all"),n.on("keydown",(function(t){if(!t.ctrlKey||t.altKey||t.shiftKey||t.keyCode!="A".charCodeAt(0))if(!t.ctrlKey||t.altKey||t.shiftKey||t.keyCode!="M".charCodeAt(0))if(t.ctrlKey&&t.altKey&&!t.shiftKey&&65==t.keyCode)e(".add_new_feed_link").click();else if(t.ctrlKey&&t.altKey&&!t.shiftKey&&82==t.keyCode)feedit.resetSelectedItemsCache(),n.trigger("item-select",[{origin:"content_refresh"}]),n.trigger("refresh-content",[null,null,null,{first_load:!0}]);else if(!t.ctrlKey||t.altKey||t.shiftKey||37!=t.keyCode)if(!t.ctrlKey||t.altKey||t.shiftKey||39!=t.keyCode)!t.shiftKey||t.altKey||189!=t.keyCode&&109!=t.keyCode?!t.shiftKey||t.altKey||187!=t.keyCode&&107!=t.keyCode?!t.shiftKey||t.altKey||56!=t.keyCode&&106!=t.keyCode?!t.shiftKey&&t.altKey&&t.ctrlKey&&73==t.keyCode?n.trigger("invert-selection"):!t.shiftKey&&t.altKey&&t.ctrlKey&&96==t.keyCode&&e("#feed_cleanup_icon").click():Object.keys(feedit.getSelectedItemsCache()).length&&e("#multi_mark_read").click():Object.keys(feedit.getSelectedItemsCache()).length&&n.trigger("train-simple-multi",[{way:"up",dont_refresh_content:!!t.ctrlKey}]):Object.keys(feedit.getSelectedItemsCache()).length&&n.trigger("train-simple-multi",[{way:"down",dont_refresh_content:!!t.ctrlKey}]);else{var o=feedit.getActiveFeedItem().next("ion-item.feed_item");o.length&&o.click()}else{var a=feedit.getActiveFeedItem().prev("ion-item");a.length&&a.click()}else e("#simple_mode").click();else("INPUT"!=document.activeElement.tagName||"text"!=document.activeElement.type&&"number"!=document.activeElement.type&&"email"!=document.activeElement.type&&"password"!=document.activeElement.type&&"tel"!=document.activeElement.type&&"url"!=document.activeElement.type&&"search"!=document.activeElement.type)&&"TEXTAREA"!=document.activeElement.tagName&&(t.preventDefault(),i.click())}))}))}(jQuery),function(e){var i,n,t=e(document),o={},a=!1,l={};function s(){var i=Object.keys(feedit.getSelectedItemsCache()),n={},t=[];for(var o of i){var a=e('#main ion-item-sliding ion-item[data-id="'+o+'"] ion-badge.prediction');if(1==a.length){var l=a.first().data("id");void 0===n[l]&&(n[l]=[]),n[l].push(o)}else a.each((function(){var i=e(this);void 0===t[o]&&(t[o]=[]),t[o].push(i.data("id"))}))}for(var s in n){var d=e('ion-select-option[value="'+s+'"]').first().text(),r=[{id:s,txt:d}];e('#main ion-item-sliding ion-item ion-badge.prediction[data-id="'+s+'"]').removeClass("prediction").find("small").text(d),feedit.callAPI("api/labels_give.php",{links:n[s],labels:[s]},(function(e){if(""==e){for(var t of n[s])for(var o of i)t==o&&(feedit.getSelectedItemsCache()[o].labels=r);feedit.presentToast({txt:window.lang.labels_updated})}else feedit.defaultErrorNotification()}))}for(var o in t)feedit.callAPI("api/labels_give.php",{links:[o],labels:t[o]},(function(i){if(""==i){var n=[];for(var a of t[o]){var l=e('ion-select-option[value="'+a+'"]').first().text();n.push({id:a,txt:l}),e('#main ion-item-sliding ion-item ion-badge.prediction[data-id="'+a+'"]').removeClass("prediction").find("small").text(l)}feedit.getSelectedItemsCache()[o].labels=n}else feedit.defaultErrorNotification()}))}function d(){o={},n.find("ion-select-option").each((function(){var i=e(this);o[i.val()]=i.text()}))}function r(e){return void 0===e&&(e=!1),"\n            <ion-icon "+(e?`data-id="${e.id}" `:"")+'class="ion-float-right label_remove" name="close-sharp" color="danger" size="large"></ion-icon>\n            <ion-label>\n              <ion-input '+(e?`data-id="${e.id}" data-old-value="${e.name}" value="${e.name}" `:"")+'class="label_name'+(e?"":" newly_added")+'"></ion-input>\n            </ion-label>'}t.on("app-init",(function(){n=e("#filter_labels"),i=n.val(),customElements.define("modal-labels-manage",class extends HTMLElement{connectedCallback(){var i=[];i.push(`\n  <ion-header>\n    <ion-toolbar>\n      <ion-title>${window.lang.manage_labels}</ion-title>\n      <ion-buttons slot="primary">\n        <ion-button onClick="feedit.showHelp($(this).find('ion-icon')[0], 'manage-labels')">\n          <ion-icon slot="icon-only" name="information-circle-outline" title="${window.lang.manage_labels_help}"></ion-icon>\n        </ion-button>\n        <ion-button onClick="feedit.dismissModal()">\n          <ion-icon slot="icon-only" name="close"></ion-icon>\n        </ion-button>\n      </ion-buttons>\n    </ion-toolbar>\n  </ion-header>\n  <ion-content class="ion-padding">\n    <ion-label><strong>${window.lang.labels_for_feed}:</strong></ion-label>\n    <ion-select id="labels_feed" placeholder="${window.lang.select_feed}" cancel-text="${window.lang.cancel}" ok-text="${window.lang.confirm}">`),e(".feed_item").each((function(){var n=e(this);i.push('<ion-select-option value="'+n.data("id")+'">'+n.find("h3 span").html()+"</ion-select-option>")})),i.push(`\n    </ion-select>\n\n    <br>\n    <ion-spinner id="labels_loading" name="lines" class="ion-hide"></ion-spinner>\n\n    <div id="labels_management_container" class="ion-hide">\n      <br>\n      <ion-label><strong>${window.lang.labels_camelcase}:</strong></ion-label>\n\n      <br>\n      <br>\n      <div id="labels_list">\n        \x3c!-- preload inputs and icons through empty template //--\x3e\n        <ion-icon name="close-sharp" color="danger" size="large"></ion-icon>\n        <ion-label>\n          <ion-input></ion-input>\n        </ion-label>\n        \x3c!-- preload end //--\x3e\n      </div>\n\n      <br>\n      <ion-button id="add_new_label" color="success">\n        <ion-icon slot="start" name="add-circle"></ion-icon>\n        ${window.lang.add_new_label}\n      </ion-button>\n    </div>\n\n    <br>\n    <br>\n\n    <div class="ion-float-right top10px">\n      <a href="javascript:feedit.dismissModal()" class="ion-margin">${window.lang.cancel}</a>\n      <ion-button color="primary" id="update_labels" disabled>${window.lang.confirm}</ion-button>\n    </div>\n  </ion-content>\n    `),this.innerHTML=i.join("")}}),t.on("ionChange","#labels_feed",(function(i){e("#labels_management_container").addClass("ion-hide"),e("#labels_loading").removeClass("ion-hide"),e("#update_labels").attr("disabled","disabled"),l={},feedit.callAPI("api/labels_get.php",{feed:i.originalEvent.detail.value},(function(i){if("object"==typeof i){var n=[];for(var t of i)n.push(r(t)),n.push("<br>");n.pop(),e("#labels_list").html(n.join("")),e("#labels_management_container").removeClass("ion-hide"),e("#labels_loading").addClass("ion-hide")}else feedit.defaultErrorNotification()}))})),t.on("click",".label_remove",(function(){var i=e(this);i.next("ion-label").hasClass("newly_added")||(l.removals||(l.removals=[]),l.removals.push(i.data("id"))),i.next("ion-label").remove(),i.next("br").remove(),i.remove(),e("#update_labels").removeAttr("disabled")})),t.on("click","#add_new_label",(function(){e("#labels_list").append("<br>"+r()),e("#update_labels").removeAttr("disabled"),setTimeout((function(){e(".label_name").last()[0].setFocus()}),500)})),t.on("ionChange",".label_name",(function(){e("#update_labels").removeAttr("disabled")})),t.on("click","#update_labels",(function(){if(e(".newly_added").each((function(){var i=e(this);i.val()&&(l.additions||(l.additions=[]),l.additions.push(i.val()))})),e("#labels_list ion-label").each((function(){var i=e(this).find("ion-input");i.hasClass("newly_added")||i.data("old-value")!=i.val()&&(l.changed||(l.changed=[]),l.changed.push({id:i.data("id"),val:i.val()}))})),Object.keys(l).length){l.feed=e("#labels_feed").val(),feedit.dismissModal(),t.trigger("show-loading",[window.lang.saving_data]);var i=!1;feedit.callAPI("api/labels_save.php",l,(function(o){if(""==o){var a=feedit.getActiveFeedId();if(a!=l.feed&&"bookmarks"!=a&&"all"!=a||feedit.cache_labels(feedit.getActiveFeedId()),void 0!==l.removals){var s=[];for(var d of l.removals)s.push('.label_badge[data-id="'+d+'"], #filter_labels ion-select-option[value="'+d+'"]'),n.val()==d&&(n.val(""),i=!0);e(s.join(",")).remove(),i&&t.trigger("refresh-content",[null,null,null,{first_load:!0}])}if(!i&&void 0!==l.changed)for(var r of l.changed)e('.label_badge[data-id="'+r.id+'"] small').text(r.val);feedit.cache_labels()}else feedit.defaultErrorNotification()}),null,(function(){i||t.trigger("hide-loading")}))}else feedit.dismissModal()})),setTimeout(feedit.cache_labels,150),t.on("ionAlertWillDismiss",(function(){var e=n.val();e&&"string"==typeof e&&(e=[e]),e&&e.join(",")!=i&&(t.trigger("refresh-content",[null,null,null,{first_load:!0}]),i=e.join(","),Cookies.set("filter_labels",i,{expires:365}))})),t.on("click","ion-label ion-badge.label_badge",(function(){if(this.className.indexOf("prediction")>-1||this.className.indexOf("longpressed")>-1)return!0;n.val(e(this).data("id"));var o=n.val();o&&"string"==typeof o&&(o=[o]),i=o,t.trigger("refresh-content",[null,null,null,{first_load:!0}])})),t.on("click","#multi_labels, .labels",(function(i){"multi_labels"==this.id&&i.shiftKey||this.className.indexOf("longpressed")>-1||function(i){t.trigger("show-loading"),e("#labelsTrainer").remove();var n=['<ion-select id="labelsTrainer" interface="alert" cancel-text="'+window.lang.cancel+'" ok-text="'+window.lang.confirm+'" multiple="true" class="ion-no-padding ion-hide" data-initialized="0"'],a=[],l={},s=feedit.getActiveFeedId();if("ION-BADGE"==i[0].tagName){var d=i.closest("ion-item"),r=d.find("ion-label h2 a"),c=i.closest("p.actions"),g=d.find(".feed_name_badge small").text();d.length||(d=i.closest("ion-text"),r=d.find("h2 a")),n[0]+='data-id="'+d.data("id")+'"',l.header=window.lang.assign_labels+" ("+r.text().replace(" ","")+")"}else n[0]+='data-id="multiple"',l.header=window.lang.assign_labels+" ("+(1==feedit.countSelectedItemsCachedObjects()?feedit.getFirstSelectedItemCachedObject().title:feedit.countSelectedItemsCachedObjects()+" "+window.lang.articles)+")";if(n[0]+=">",Object.keys(feedit.getSelectedItemsCache()).length)for(var m of Object.keys(feedit.getSelectedItemsCache()))for(var f of feedit.getSelectedItemsCache()[m].labels)-1==a.indexOf(f.id)&&a.push(f.id);else c.find("ion-badge.label_badge").each((function(){a.push(e(this).data("id"))}));for(var h in o)("bookmarks"!=s&&"all"!=s||-1!=o[h].indexOf("("+g+")"))&&n.push('<ion-select-option class="label_option" value="'+h+'">'+o[h]+"</ion-select-option>");n.push("</ion-select>"),e("body").append(n.join("")),setTimeout((function(){var i=e("#labelsTrainer")[0];i.value=a,i.interfaceOptions=l,i.open().then((function(){t.trigger("hide-loading")}))}),100)}(e(this))})),t.on("ionChange","#labelsTrainer",(function(i){var n=e(this),t=[];n.data("initialized")?("multiple"!=n.data("id")?t.push(n.data("id")):t=Object.keys(feedit.getSelectedItemsCache()),feedit.callAPI("api/labels_give.php",{links:t,labels:i.originalEvent.detail.value.length?i.originalEvent.detail.value:"empty"},(function(n){if(""==n){var o=[],a=Object.keys(feedit.getSelectedItemsCache());for(var l of i.originalEvent.detail.value){var s=e('ion-select-option[value="'+l+'"]').first().text();o.push({id:l,label:s,txt:s})}for(var d of t){var r=e('#main ion-item-sliding ion-item[data-id="'+d+'"]'),c=e('#training_slider ion-slide[data-id="'+d+'"]'),g=r.find(".bookmark"),m=c.find("p.actions .labels").first();if(r.add(c).find(".label_badge").remove(),g.add(m).after(feedit.getLabelsHTML(o)),a.length)for(var f of a)d==f&&(feedit.getSelectedItemsCache()[f].labels=o)}feedit.presentToast({txt:window.lang.labels_updated})}else feedit.defaultErrorNotification()}))):n.data("initialized",1)})),t.on("click",".prediction",(function(i){var n=e(this);if(n.hasClass("longpressed"))return!0;n.find("small").text(n.find("small").text().slice(0,-1)),feedit.callAPI("api/labels_give.php",{links:[n.closest("ion-item").data("id")],labels:[n.data("id")]},(function(e){""==e?n.removeClass("prediction"):(n.find("small").text(n.find("small").text()+"*"),feedit.defaultErrorNotification())}))})),t.on("click","#multi_labels",(function(i){!i.shiftKey||this.className.indexOf("longpressed")>-1?e(this).removeClass("longpressed"):s()})),t.on("longpress","#multi_labels",(function(){e(this).addClass("longpressed"),s()})),t.on("longpress","#main .label_badge",(function(){var i=e(this);return i.addClass("longpressed"),e('#main .label_badge[data-id="'+i.data("id")+'"]').each((function(){var i=e(this).closest("ion-item-sliding");i.hasClass("ion-hide")||i.hasClass("child_highlighted")||feedit.highlightItem(i)})),setTimeout((function(){i.removeClass("longpressed")}),1e3),!1})),e.extend(feedit,{showLabelsManager(){a||(a=!0,t.trigger("show-loading"),async function(e){t.trigger("open-modal",[await modalController.create({component:"modal-labels-manage"}),e]),a=!1}((function(){setTimeout((function(){var i=feedit.getActiveFeedItem().data("id");"bookmarks"!=i&&"all"!=i&&e("#labels_feed").val(feedit.getActiveFeedItem().data("id"))}),500)})))},cache_labels(i){void 0!==i?feedit.callAPI("api/labels_get.php",{feed:i},(function(i){if("object"==typeof i){n.find("ion-select-option").remove();var t=[],o=n.val(),a=!1,l=feedit.getActiveFeedId();for(var s of i)a=!0,t.push(`\n                  <ion-select-option value="${s.id}">${s.name}</ion-select-option>`);a&&n.append(t.join("")),setTimeout((function(){if(a&&n.val(o),d(),a)if(e("#active_feed_title_header, #labels-select-badge").removeClass("ion-hide no-labels simple-mode-ignore"),feedit.getActiveFeedItem().hasClass("feed_item")?e("#multi_labels").removeClass("ion-hide no-labels simple-mode-ignore"):e("#multi_labels").addClass("ion-hide"),feedit.isSimpleMode())"bookmarks"!=l&&"all"!=l&&e("ion-badge.labels").removeClass("simple-mode-ignore");else{var i="ion-hide";"bookmarks"!=l&&"all"!=l&&(i+=" simple-mode-ignore"),e("ion-badge.labels").removeClass(i)}else e("#labels-select-badge, ion-badge.labels, #multi_labels").addClass("ion-hide"),e("#active_feed_title_header").addClass("no-labels"),e("ion-badge.labels").addClass("simple-mode-ignore")}),100)}else feedit.defaultErrorNotification()})):d()}})}))}(jQuery),function(e){var i,n,t,o=e(document),a=!1,l=!1;function s(i){return'\n          <ion-item button class="feed_item ion-no-border'+(Cookies.get("feed-active")==i.id?" active":"")+`" lines="none" title="${i.title}" data-id="${i.id}" data-url="${i.url}" data-lang="${i.lang}" data-allow-duplicates="${i.allow_duplicates}">\n            <ion-label>\n              <h3>\n                <img src="${i.icon}" class="ion-float-left">\n                <span`+(void 0!==i.tiers_training_check&&i.tiers_training_check?' class="trained"':"")+`>${i.title}</span>\n              </h3>\n            </ion-label>\n            <ion-badge slot="end" class="links_counter`+(e("#remove_feeds").prop("checked")?" ion-hide":"")+`">\n              \x3c!--<ion-badge color="success">0</ion-badge> //--\x3e\n              <ion-badge color="light">${i.count}</ion-badge>\n            </ion-badge>\n            <ion-icon name="trash-bin" slot="end" size="small" class="`+(e("#remove_feeds").prop("checked")?"":"ion-hide")+'" color="danger"></ion-icon>\n            <ion-spinner name="lines-small" slot="end" class="ion-hide"></ion-spinner>\n          </ion-item>\n        '}o.on("app-init",(function(){i=e("#main_menu"),n=e("#menu_show"),t=!i.hasClass("ion-hide"),customElements.define("popover-left-item-menu",class extends HTMLElement{connectedCallback(){var e=[];e.push('\n        <ion-content id="left-menu-item-popover">\n          <ion-list>\n            <ion-list-header>'+feedit.getTopPopover().componentProps.title+"</ion-list-header>\n            <ion-item button onclick=\"feedit.markFeedRead('"+feedit.getTopPopover().componentProps.feed_id+`'); feedit.dismissPopover();">${window.lang.mark_feed_read}</ion-item>\n            <ion-item button onclick="feedit.trainAllUp('`+feedit.getTopPopover().componentProps.feed_id+`'); feedit.dismissPopover();">${window.lang.like_all_feed_articles}</ion-item>\n            <ion-item button onclick="feedit.trainAllDown('`+feedit.getTopPopover().componentProps.feed_id+`'); feedit.dismissPopover();">${window.lang.dislike_all_feed_articles}</ion-item>\n            <ion-item button onclick="feedit.instaFetchFeed('`+feedit.getTopPopover().componentProps.feed_id+`'); feedit.dismissPopover();">${window.lang.insta_fetch_articles}</ion-item>\n            <ion-item button onclick="feedit.presentUpdateFeedDialog('`+feedit.getTopPopover().componentProps.feed_id+`'); feedit.dismissPopover();">${window.lang.edit_feed}</ion-item>\n            <ion-item button onclick="feedit.presentRemoveFeedDialog('`+feedit.getTopPopover().componentProps.feed_id+`'); feedit.dismissPopover();">${window.lang.remove_feed}</ion-item>\n            <ion-item lines="none" detail="false" button onClick="feedit.dismissPopover()">${window.lang.close}</ion-item>\n          </ion-list>\n        </ion-content>`),this.innerHTML=e.join("")}}),o.on("update-feeds-counts",(function(i,n){for(var t of n)e('.feeds ion-item[data-id="'+t.id+'"] .links_counter ion-badge').text(t.count)})),o.on("left-menu-feeds-update",(function(i,n,t){e(".feeds .feed_item").remove();var o=[];for(var a in n)o.push(s(n[a]));o.length?(e(".root_menu .bookmarks_item").after(o.join("")),e(".labels_management").removeClass("ion-hide"),void 0===Cookies.get("feed_well_trained_info_shown")&&e(".feeds span.trained").length&&(Cookies.set("feed_well_trained_info_shown",1,{expires:365}),feedit.presentToast({txt:window.lang.feed_well_trained_info,duration:3e4}))):e(".labels_management").addClass("ion-hide"),"function"==typeof t&&t()})),o.on("left-menu-feeds-add",(function(i,n){var t=[];for(var o in n)t.push(s(n[o]));t.length?(e(".root_menu .add_new_feed_link").before(t.join("")),e(".labels_management").removeClass("ion-hide")):e(".labels_management").addClass("ion-hide")})),o.on("click","#menu_hide, #menu_show",(function(){i.add(n).toggleClass("ion-hide"),t=!i.hasClass("ion-hide"),o.trigger("show-hide-splitter",[t?"show":"hide"]),Cookies.set("left-menu-visible",t,{expires:365})})),o.on("click","#menu_hide_mobile",(function(){i[0].close(!0)})),o.on("desktop-sized-change",(function(e,t){a?!t&&i.hasClass("ion-hide")?(i.addClass("was_hidden").removeClass("ion-hide"),n.addClass("ion-hide")):t&&i.hasClass("was_hidden")&&(i.removeClass("was_hidden").addClass("ion-hide"),n.removeClass("ion-hide")):a=!0})),o.on("ionChange","#filter_status, #filter_sort, #filter_hiding, #filter_per_page",(function(){Cookies.set(this.id+"-"+feedit.getActiveFeedItem().data("id"),this.value,{expires:365}),Cookies.set(this.id,this.value,{expires:365}),-1==this.className.indexOf("no_content_change")?o.trigger("refresh-content",[null,null,null,{first_load:!0}]):e(this).removeClass("no_content_change"),"filter_hiding"==this.id&&(("all"==feedit.getActiveFeedId()||"bookmarks"==feedit.getActiveFeedId())&&e(".feeds span.trained").length<e(".feeds .feed_item").length&&void 0===Cookies.get("all_feeds_not_well_trained_warning")?(Cookies.set("all_feeds_not_well_trained_warning",1,{expires:365}),feedit.presentToast({txt:window.lang.multi_feeds_tiers_slider_used_with_untrained_feeds,duration:6e4})):feedit.getActiveFeedItem().find("h3 span").hasClass("trained")||void 0!==Cookies.get("feed_not_well_trained_warning")||(Cookies.set("feed_not_well_trained_warning",1,{expires:365}),feedit.presentToast({txt:window.lang.tiers_slider_used_with_untrained_feed,duration:6e4})))})),o.on("contextmenu",".feed_item",(function(i){if(!l)return l=!0,e(this).addClass("longpressed"),async function(e,i,n){o.trigger("open-popover",[await popoverController.create({component:"popover-left-item-menu",showBackdrop:!1,event:e,componentProps:{feed_id:i,title:n}})]),l=!1}(i,e(this).data("id"),e(this).find("ion-label h3 span").text()),!1})),e.extend(feedit,{leftMenuShowing:()=>t})}))}(jQuery),function(e){var i,n=jQuery(document),t=!1;n.on("app-init",(function(){n.on("show-loading",(function(e,n,o){t||(t=!0,(i=document.createElement("ion-loading")).message=void 0!==n?n:window.lang.loading,void 0!==o&&(i.duration=o),document.body.appendChild(i),i.present().then((function(){const{role:e,data:n}=i.onDidDismiss().then((function(){}))})))})),n.on("hide-loading",(function(){t=!1,i.dismiss()}))}))}(),function(e){var i=e(document),n=[],t=[];i.on("app-init",(function(){i.on("open-popover",(function(e,i){t.push(i),i.present()})),i.on("open-modal",(function(e,t,o){n.push(t),t.present().then((function(){i.trigger("hide-loading"),"function"==typeof o&&o()}))})),i.on("dismiss-popover",(function(){if(t.length){var i=e(".popover-wrapper ion-content").last().attr("id");t[t.length-1].dismiss({id:i})}})),i.on("dismiss-modal",(function(){if(n.length){var i=e(".modal-wrapper ion-content").last().attr("id");n[n.length-1].dismiss({id:i})}})),i.on("ionPopoverDidDismiss",(function(){t.pop()})),i.on("ionModalDidDismiss",(function(){n.pop()})),e.extend(feedit,{dismissPopover(){i.trigger("dismiss-popover")},dismissModal(){i.trigger("dismiss-modal")},getTopPopover:()=>t.length?t[t.length-1]:null,getTopModal:()=>n.length?n[n.length-1]:null})}))}(jQuery),function(e){var i,n,t=e(document),o={};function a(i){o[i.data("id")]={id:i.data("id"),title:i.find("ion-label h2 a").text(),labels:i.find("ion-badge.label_badge").map((function(){var i=e(this);return{id:i.data("id"),txt:i.find("small").text()}})).toArray()},!feedit.isSimpleMode()&&i.find(".train_up").hasClass("ion-hide")||feedit.isSimpleMode()&&!i.find(".train_up").hasClass("shown-outside-simple-mode")?o[i.data("id")].trained=0:!feedit.isSimpleMode()&&i.find(".train_down").hasClass("ion-hide")||feedit.isSimpleMode()&&!i.find(".train_down").hasClass("shown-outside-simple-mode")?o[i.data("id")].trained=1:o[i.data("id")].trained=-1}function l(e){delete o[e.data("id")]}function s(){e("#main ion-item-sliding").not(".ion-hide").each((function(){feedit.highlightItem(e(this))}))}t.on("app-init",(function(){i=e("#multiselect_actions"),n=e("#select_all"),t.on("invert-selection",(function(){e(this).addClass("changed_from_select_event switch_to_previous_state"),s()})),t.on("longpress","#select_all",(function(){e(this).addClass("changed_from_select_event switch_to_previous_state"),s()})),t.on("mousedown touchstart","#select_all",(function(i){i.shiftKey&&(e(this).addClass("changed_from_select_event switch_to_previous_state"),s())})),t.on("ionChange","#select_all",(function(i){var n=e(this);if(n.hasClass("changed_from_select_event"))return n.removeClass("changed_from_select_event"),void(n.hasClass("switch_to_previous_state")&&n.removeClass("switch_to_previous_state").addClass("changed_from_select_event").prop("checked",!i.originalEvent.detail.checked));i.originalEvent.detail.checked?e("ion-item-sliding").not(".child_highlighted, .ion-hide").each((function(){a(e(this).addClass("child_highlighted").find("ion-item").addClass("selected_item")),t.trigger("item-select",[{origin:"select_all"}])})):e("ion-item-sliding.child_highlighted").not(".ion-hide").each((function(){e(this).removeClass("child_highlighted").find("ion-item").removeClass("selected_item"),feedit.resetSelectedItemsCache(),t.trigger("item-select",[{origin:"select_all"}])}))})),t.on("item-select",(function(t,o){feedit.countSelectedItemsCachedObjects()?(void 0!==o&&void 0!==o.origin&&"content_refresh"==o.origin||i.removeClass("ion-hide"),void 0!==o&&void 0!==o.origin&&"select_all"==o.origin||(e(".selected_item").length!=e("ion-item-sliding").not(".ion-hide").length||n.prop("checked")?e(".selected_item").length!=e("ion-item-sliding").not(".ion-hide").length&&n.prop("checked")&&n.addClass("changed_from_select_event").prop("checked",!1):(void 0!==o&&void 0!==o.origin&&"content_refresh"==o.origin&&n.addClass("changed_from_select_event"),n.prop("checked",!0)))):void 0===o||void 0===o.origin||"content_refresh"!=o.origin?i.addClass("ion-hide"):void 0!==o&&void 0!==o.origin&&"content_refresh"==o.origin&&n.prop("checked")&&n.addClass("changed_from_select_event").prop("checked",!1)})),t.on("mousedown","ion-item-sliding",(function(i){if(i.shiftKey){var n=e(this),o=n.find("ion-item");n.toggleClass("child_highlighted"),o.toggleClass("selected_item").addClass("highlight_action_occured"),o.hasClass("selected_item")?a(o):l(o),setTimeout((function(){o.removeClass("highlight_action_occured")}),500),t.trigger("item-select")}})),t.on("touchstart click","ion-item-sliding",(function(i){if("ION-ITEM-SLIDING"!=this.tagName)(n=e(this).closest("ion-item-sliding"))[0];else var n=e(this);if(feedit.countSelectedItemsCachedObjects())return"click"!=i.type||n.find("ion-item").first().hasClass("highlight_action_occured")||feedit.highlightItem(n,i),!0;"click"!=i.type&&(n.data("mouseheld_timer")||n.hasClass("item-sliding-active-slide")||n.find("ion-item").first().hasClass("highlight_action_occured")||n.addClass("mouseheld_timer").data({mouseheld_timer:setTimeout((function(){feedit.highlightItem(n,i)}),500),mPosX:i.pageX,mPosY:i.pageY}))})).on("touchmove touchend touchcancel","ion-item-sliding",(function(i){if(!feedit.countSelectedItemsCachedObjects()){if("ION-ITEM-SLIDING"!=this.tagName)var n=(t=e(this).closest("ion-item-sliding"))[0];else{var t=!1;n=this}void 0!==n&&-1!=n.className.indexOf("mouseheld_timer")&&(!1===t&&(t=e(this)),feedit.checkAndRemoveLongPressTimer(t,i))}})),t.on("restore-highlight",(function(e,i){i.hasClass("was_selected")&&(a(i.toggleClass("selected_item was_selected")),i.closest("ion-item-sliding").addClass("child_highlighted"))})),t.on("hide-highlight",(function(i,n){n.className.indexOf("child_highlighted")>-1&&l(e(n).removeClass("child_highlighted").find(".selected_item").toggleClass("selected_item was_selected"))})),e.extend(feedit,{getSelectedItemsCache:()=>o,resetSelectedItemsCache(){o={}},countSelectedItemsCachedObjects:()=>Object.keys(o).length,getFirstSelectedItemCachedObject(){for(var e in o)return o[e]},untickSelectAllCheckbox(){n.addClass("changed_from_select_event").prop("checked",!1),setTimeout((function(){n.removeClass("changed_from_select_event")}),500)},hide_all_selected_items(n,o){for(var a of Object.keys(feedit.getSelectedItemsCache()))e('#main ion-item-sliding ion-item[data-id="'+a+'"]').removeClass("selected_item").closest("ion-item-sliding").addClass("ion-hide").removeClass("child_highlighted");feedit.resetSelectedItemsCache(),i.addClass("ion-hide"),feedit.untickSelectAllCheckbox(),e("#main ion-item-sliding").not(".ion-hide").length||(e("#next_page, #prev_page").addClass("ion-hide"),null!=typeof o&&!0===o||t.trigger("show-loading"),null!=typeof n&&!0===n||t.trigger("refresh-content",[null,null,null,{first_load:!0}]))},hide_single_item(n,o,a){n.removeClass("selected_item").closest("ion-item-sliding").addClass("ion-hide").removeClass("child_highlighted"),l(n),feedit.countSelectedItemsCachedObjects()||(i.addClass("ion-hide"),feedit.untickSelectAllCheckbox()),e("#main ion-item-sliding").not(".ion-hide").length||(null!=typeof a&&!0===a||t.trigger("show-loading"),null!=typeof o&&!0===o||t.trigger("refresh-content",[null,null,null,{first_load:!0}]))},highlightItem(i,n){if(void 0!==n&&"ION-ITEM"==n.target.tagName)var o=(s=e(n.target)).parent("ion-item-sliding");else{o=i;var s=i.find("ion-item").first()}o.hasClass("item-sliding-active-slide")||(s.addClass("highlight_action_occured").toggleClass("selected_item"),s.hasClass("selected_item")?a(s):l(s),i.toggleClass("child_highlighted"),i.removeData("mouseheld_timer").removeClass("mouseheld_timer"),setTimeout((function(){s.removeClass("highlight_action_occured")}),500),void 0!==n?t.trigger("item-select",[s]):t.trigger("item-select",[{origin:"select_all"}]))}})}))}(jQuery),function(e){var i=e(document),n=-1,t=null,o=!1;i.on("app-init",(function(){i.on("mousedown","ion-item, #training_slider ion-badge ion-icon",(function(){var i=e(this),o="ION-ITEM"==this.tagName?e(this).data("id"):i.parent("ion-badge").data("id");n>-1?t!=o?(t=o,n=Date.now()):Date.now()-n<=feedit.getDoubleClickDelayTime()?e(this).trigger("doubleclick"):n=Date.now():(n=Date.now(),t=o)})),i.on("mousedown touchstart","#training_slider ion-badge ion-icon, .feed_item, #multi_mark_read, #multi_vote_down, #multi_vote_up, #multi_labels, #select_all, #main .label_badge",(function(i){var n=e(this);if(o=!1,"touchstart"==i.type)n.addClass("touchstarted");else if(n.hasClass("touchstarted"))return void n.removeClass("touchstarted");n.addClass("mouseheld_timer").data({mouseheld_timer:setTimeout((function(){o||n.trigger("longpress")}),feedit.getLongPressDelayTime())})})).on("mouseup touchend","#training_slider ion-badge ion-icon, .feed_item, #multi_mark_read, #multi_vote_down, #multi_vote_up, #multi_labels, #select_all, #main .label_badge",(function(i){var n=e(this);if("touchend"==i.type)n.addClass("touchended");else if(n.hasClass("touchended"))return void n.removeClass("touchended");n.hasClass("mouseheld_timer")&&feedit.checkAndRemoveLongPressTimer(n,i)})),e("#main ion-content")[0].getScrollElement().then((function(i){e(i).on("scroll",(function(){o=!0}))})),e("#main_menu ion-content")[0].getScrollElement().then((function(i){e(i).on("scroll",(function(){o=!0}))})),e.extend(feedit,{checkAndRemoveLongPressTimer(e,i){e.data("mouseheld_timer")?(clearTimeout(e.data("mouseheld_timer")),e.removeData(["mouseheld_timer"]).removeClass("mouseheld_timer")):(console.log("Unexpected state: no timer exists for a timer-classed element",e),o=!1)}})}))}(jQuery),function(e){var i,n,t=e(document);t.on("app-init",(function(){i=e(".splitter_touch_handle"),n=e("#splitter"),e("#main_menu").resizable({handleSelector:"#splitter, .splitter_touch_handle",resizeHeight:!1,onDragEnd:function(){Cookies.set("left-menu-width",e("#main_menu").width(),{expires:365})}}),t.on("touchstart",".splitter_touch_handle, #splitter",(function(){feedit.leftMenuShowing()&&i.css("opacity",1)})),t.on("touchend touchcancel",".splitter_touch_handle, #splitter",(function(){feedit.leftMenuShowing()&&i.css("opacity",0)})),t.on("show-hide-splitter",(function(e,i){"show"==i?n.removeClass("ion-hide"):n.addClass("ion-hide")}))}))}(jQuery),function(e){var i=e(document),n=-1;i.on("app-init",(function(){i.on("ionDrag",(function(t){n>-1&&(clearTimeout(n),n=-1),i.trigger("hide-highlight",[t.target]),n=setTimeout((function(){!function t(o){if(feedit.isMouseDown())clearTimeout(n),n=setTimeout((function(){t(o)}),1e3);else if(e(".item-sliding-active-slide").length){var a=e(o.target),l=a.find("ion-item").first(),s=a.find('ion-item-options[side="'+(o.originalEvent.detail.ratio<0?"start":"end")+'"]').find("ion-item-option:first"),d=!1;if(o.originalEvent.detail.ratio<0&&o.originalEvent.detail.ratio<-.35?(l.find("ion-badge.train_down").click(),d=!0):o.originalEvent.detail.ratio>.35&&(l.find("ion-badge.train_up").click(),d=!0),o.target.close(),!d)return;setTimeout((function(){l.css({transition:"0.25s","background-color":s.css("background-color")}),setTimeout((function(){l.css({transition:"0.22s","background-color":""}),setTimeout((function(){i.trigger("restore-highlight",[l])}),220)}),250)}),250)}}(t)}),600)})),i.on("toggle-swipable-training-items",(function(){e("ion-badge.ion-hide-xl-down:visible").length>1?e("ion-item-sliding").attr("disabled","disabled"):e("ion-item-sliding").removeAttr("disabled"),setTimeout((function(){e("#menu_show:visible").length||e("#menu_hide:visible").length?i.trigger("desktop-sized-change",[!0]):i.trigger("desktop-sized-change",[!1])}),100)}))}))}(jQuery),function(e){var i=jQuery(document);i.on("app-init",(function(){i.on("training-data-gather",(function(e,i){"author"==i.badge_type&&("basic"==i.gather_type?i.data.author={name:i.$icon.siblings("ion-label").text(),rate:"thumbs-up-sharp"==i.$icon.attr("name")?1:0,rate_intensity:i.intensity}:"new_ignored"==i.gather_type?i.data.author={name:i.$badge.find("ion-label").text(),rate:-1}:"prev_ignored"==i.gather_type&&(i.data.author={name:i.$badge.find("ion-label").text(),rate:2}))})),i.on("training-modal-add-html",(function(e,i){"author"==i.type&&(i.html_array.push('\n            <p class="added_actions training_content_author ion-hide">'),i.item.author&&i.html_array.push('\n              <ion-badge class="'+(i.item.labels?"left5px ":"")+"author_label"+(i.item.author.ignored?" ignored":"")+'" style="background-color: '+(i.item.author.ignored?i.ignored_badge_bg_color:i.item.author.bg_color)+`" data-unignored-color="${i.item.author.bg_color}" title="`+(i.item.author.ignored?window.lang.author_ignored_from_scoring:i.item.author.name)+'"'+(i.item.author.ignored?' data-was-ignored="1"':"")+` data-id="${i.item.author.name}" data-type="author">\n                <ion-icon name="eye-off-sharp" class="ion-float-left right10px`+(i.item.author.ignored?"":" ion-hide")+'"></ion-icon>\n                <ion-icon name="thumbs-down-sharp" class="ion-float-left right10px'+(i.item.author.ignored?" ion-hide":"")+`"></ion-icon>\n                <ion-label>${i.item.author.name}</ion-label>\n                <ion-icon name="thumbs-up-sharp" class="ion-float-right left10px`+(i.item.author.ignored?" ion-hide":"")+'"></ion-icon>\n              </ion-badge>'),i.html_array.push("\n            </p>"))}))}))}(),function(e){var i=jQuery(document);i.on("app-init",(function(){i.on("training-data-gather",(function(e,i){"category"==i.badge_type&&("basic"==i.gather_type?(i.data.categories||(i.data.categories=[]),i.data.categories.push({name:i.$icon.siblings("ion-label").text(),rate:"thumbs-up-sharp"==i.$icon.attr("name")?1:0,rate_intensity:i.intensity})):"new_ignored"==i.gather_type?(i.data.categories||(i.data.categories=[]),i.data.categories.push({name:i.$badge.find("ion-label").text(),rate:-1})):"prev_ignored"==i.gather_type&&(i.data.categories||(i.data.categories=[]),i.data.categories.push({name:i.$badge.find("ion-label").text(),rate:2})))})),i.on("training-modal-add-html",(function(e,i){if("categories"==i.type){if(i.html_array.push('\n              <p class="added_actions training_content_categories ion-hide">'),i.item.categories)for(var n of i.item.categories)i.html_array.push('\n                <ion-badge class="category_label '+(n.ignored?"ignored ":"")+'right5px" style="background-color: '+(n.ignored?i.ignored_badge_bg_color:n.bg_color)+`" data-unignored-color="${n.bg_color}" title="`+(n.ignored?window.lang.category_ignored_from_scoring:n.name)+'"'+(n.ignored?' data-was-ignored="1"':"")+` data-id="${n.name}" data-type="category">\n                  <ion-icon name="eye-off-sharp" class="ion-float-left right10px`+(n.ignored?"":" ion-hide")+'"></ion-icon>\n                  <ion-icon name="thumbs-down-sharp" class="ion-float-left right10px'+(n.ignored?" ion-hide":"")+`"></ion-icon>\n                  <ion-label>${n.name}</ion-label>\n                  <ion-icon name="thumbs-up-sharp" class="ion-float-right left10px`+(n.ignored?" ion-hide":"")+'"></ion-icon>\n                </ion-badge>');i.html_array.push("\n              </p>")}}))}))}(),function(e){var i,n=e(document),t=!1,o=!1,a=!1,l=0;function s(i,t){var o=function(i){var n={};for(var t of Object.keys(feedit.getSelectedItemsCache())){var o=e('ion-item[data-id="'+t+'"] ion-badge.train_'+i);o.length||(o=null);var a=d(o,i,!0,feedit.getSelectedItemsCache()[t]);n[a.rating]||(n[a.rating]=[]),n[a.rating].push(a.items[0])}return n}(i);for(var a in l=0,o)n.trigger("item-training",[{rating:a,items:o[a]},null,function(){l--}]),l++;var s=setInterval((function(){0==l&&(clearInterval(s),s=-1,void 0!==r&&clearTimeout(r),e("#main ion-item-sliding").not(".ion-hide").length||n.trigger("refresh-content",[null,null,null,{first_load:!0}]))}),1e3),r=setTimeout((function(){s>-1&&l>0&&(clearInterval(s),s=-1,l=0,e("#main ion-item-sliding").not(".ion-hide").length||n.trigger("refresh-content",[null,null,null,{first_load:!0}]))}),12e4);t&&feedit.hide_all_selected_items(t)}function d(e,i,t,o){var a="up"==i?"down":"up",l="up"==i?1:0;if(void 0!==o&&o.trained==l||null!==e&&(feedit.isSimpleMode()&&!e.siblings("ion-badge.train_"+a).hasClass("shown-outside-simple-mode")||!feedit.isSimpleMode()&&e.siblings("ion-badge.train_"+a).hasClass("ion-hide"))){null!==e&&(feedit.isSimpleMode()?e.siblings("ion-badge.train_"+a).addClass("shown-outside-simple-mode").siblings("ion-badge.trained_up, ion-badge.trained_down").addClass("ion-hide"):e.siblings("ion-badge.train_"+a).removeClass("ion-hide").siblings("ion-badge.trained_up, ion-badge.trained_down").addClass("ion-hide"));var s={rating:-1,items:[void 0!==o?o.id:e.closest("ion-item").data("id")]};if(void 0!==o&&(o.trained=-1),void 0!==t)return s;n.trigger("item-training",[s])}else{null!==e&&(feedit.isSimpleMode()?e.siblings("ion-badge.train_"+a).removeClass("shown-outside-simple-mode").siblings("ion-badge.trained_"+a).addClass("ion-hide").siblings("ion-badge.train_"+i).addClass("shown-outside-simple-mode").siblings("ion-badge.trained_"+i).removeClass("ion-hide"):e.siblings("ion-badge.train_"+a+", ion-badge.trained_"+a).addClass("ion-hide").siblings("ion-badge.train_"+i+", ion-badge.trained_"+i).removeClass("ion-hide"));var d="up"==i?1:0;s={rating:d,items:[void 0!==o?o.id:e.closest("ion-item").data("id")]};if(void 0!==o&&(o.trained=d),void 0!==t)return s;n.trigger("item-training",[s])}}n.on("app-init",(function(){i=e("#labels-select-badge"),e("#filter_status"),customElements.define("modal-training",class extends HTMLElement{connectedCallback(){this.innerHTML=`\n  <ion-header>\n    <ion-toolbar>\n      <ion-title>${window.lang.article_training}</ion-title>\n      <ion-buttons slot="primary">\n        <ion-button id="training_confirm">\n          <ion-icon slot="icon-only" name="checkmark-outline" color="primary"></ion-icon>\n        </ion-button>\n        <ion-button onClick="feedit.showHelp($(this).find('ion-icon')[0], 'train-link')">\n          <ion-icon slot="icon-only" name="information-circle-outline" title="${window.lang.how_to_train_article}"></ion-icon>\n        </ion-button>\n        <ion-button onClick="feedit.dismissModal()">\n          <ion-icon slot="icon-only" name="close"></ion-icon>\n        </ion-button>\n      </ion-buttons>\n    </ion-toolbar>\n  </ion-header>\n  <ion-content class="ion-padding">\n    <ion-slides id="training_slider" pager="true">`+function(e){var t=[];for(var o in e){var a=e[o],l=feedit.getActiveFeedItem().data("id");if(t.push(`\n      <ion-slide class="ion-text-start" data-id="${a.id}" data-sc="${a.score}" data-was-trained="`+(void 0!==a.rated?1:0)+'"'+(void 0!==a.rated?' data-original-training="'+a.rated+'"':"")+`>\n        <ion-text data-id="${a.id}">\n          <h2>\n            <a href="${a.link}" target="_blank" class="link_anchor">${a.title} &raquo;</a>\n          </h2>\n          <p class="link_content">`),a.img&&t.push(`<img src="${a.img}" class="ion-float-left right10px">`),t.push(`\n            <ion-badge color="light" title="${a.date_long}">\n              <small>${a.date}</small>\n            </ion-badge>\n            <br>\n            ${a.description}\n          </p>\n\n          <p class="actions">\n            <ion-badge color="success" class="`+(void 0!==a.rated?(1==a.rated&&""!==a.rated?"icon_only":"ion-hide")+" ":"")+'train_up right5px">\n              <ion-icon name="checkmark-sharp"'+(void 0!==a.rated&&""!==a.rated?"":' class="ion-float-left right5px"')+"></ion-icon>\n              <ion-label"+(void 0!==a.rated&&""!==a.rated?' class="ion-hide"':"")+`><small>${window.lang.like}</small></ion-label>\n            </ion-badge>\n            <ion-badge color="danger" class="train_down right5px`+(void 0!==a.rated?" "+(0==a.rated&&""!==a.rated?"icon_only":"ion-hide"):"")+'">\n              <ion-icon name="close-sharp"'+(void 0!==a.rated&&""!==a.rated?"":' class="ion-float-left right5px"')+"></ion-icon>\n              <ion-label"+(void 0!==a.rated&&""!==a.rated?' class="ion-hide"':"")+`><small>${window.lang.dislike}</small></ion-label>\n            </ion-badge>`),"bookmarks"!=l&&"all"!=l&&t.push('\n            <ion-badge class="labels right5px'+(i.hasClass("ion-hide")?" ion-hide":"")+`" color="dark">\n              <ion-icon name="pricetag-outline" class="ion-float-left right5px"></ion-icon>\n              <ion-label><small>${window.lang.labels}</small></ion-label>\n            </ion-badge>`),a.label_predictions)for(var s of a.label_predictions)t.push("\n            <ion-badge "+(s.trust?'color="dark"':'style="background-color: #5E5E5E"')+` class="label_badge" data-id="${s.id}">\n              <small>${s.label}</small>\n            </ion-badge>`);if(a.labels)for(var d of a.labels)t.push(`\n            <ion-badge color="dark" class="label_badge" data-id="${d.id}">\n              <small>${d.label}</small>\n            </ion-badge>`);t.push(`\n            </p>\n            <ion-grid class="ion-no-padding training_switchbox">\n              <ion-row class="ion-text-center">\n                <ion-col data-id="words" class="ion-no-padding training_switchbox_column">\n                  <ion-tab-button>\n                    <ion-icon name="reader-outline" color="primary"></ion-icon>\n                    <ion-label color="primary">${window.lang.words}</ion-label>\n                  </ion-tab-button>\n                </ion-col>\n                <ion-col data-id="author" class="ion-no-padding training_switchbox_column">\n                  <ion-tab-button>\n                    <ion-icon name="person-outline"></ion-icon>\n                    <ion-label>${window.lang.author}</ion-label>\n                  </ion-tab-button>\n                </ion-col>\n                <ion-col data-id="categories" class="ion-no-padding training_switchbox_column">\n                  <ion-tab-button>\n                    <ion-icon name="grid-outline"></ion-icon>\n                    <ion-label>${window.lang.categories}</ion-label>\n                  </ion-tab-button>\n                </ion-col>`),n.trigger("training-modal-add-columns",[t]),t.push("\n              </ion-row>\n            </ion-grid>"),n.trigger("training-modal-add-html",[{type:"author",item:a,html_array:t,ignored_badge_bg_color:"#F4F4F4"}]),n.trigger("training-modal-add-html",[{type:"words",item:a,html_array:t,ignored_badge_bg_color:"#F4F4F4"}]),n.trigger("training-modal-add-html",[{type:"categories",item:a,html_array:t,ignored_badge_bg_color:"#F4F4F4"}]),n.trigger("training-modal-add-html",[{type:"phrases",item:a,html_array:t}]),t.push("\n        </ion-text>\n      </ion-slide>")}return t.join("")}(feedit.getTopModal().componentProps.items),e("ion-slides:first")[0].options={threshold:10,shortSwipes:!1,longSwipesMs:100,longSwipesRatio:.1,keyboard:{enabled:!0,onlyInViewport:!1}},setTimeout((function(){e("ion-slides:first")[0].update()}),1e3)}}),n.on("click",".training_switchbox_column",(function(){var i=e(this);i.find("ion-icon, ion-label").attr("color","primary"),i.siblings("ion-col").find("ion-icon, ion-label").removeAttr("color"),i.closest("ion-text").find(".training_content_"+i.data("id")).removeClass("ion-hide").siblings(".added_actions").addClass("ion-hide")})),n.on("click",".swiper-pagination-bullet",(function(){e("ion-slides:first")[0].slideTo(e(this).index())})),n.on("doubleclick","ion-item",(function(){-1!=this.className.indexOf("link")&&(e("ion-badge.train:visible").length||!feedit.isSimpleMode()&&(feedit.isSimpleMode()||feedit.isDesktopSized())||!e(this).data("id")||n.trigger("item-training-detailed",{$element:e(this).closest("ion-item-sliding")}))})),n.on("doubleclick","#training_slider ion-badge ion-icon",(function(i){"thumbs-down-sharp"!=i.target.name&&"thumbs-up-sharp"!=i.target.name||(e(i.target).addClass("longpressed").attr("color","purple").siblings().removeAttr("color"),setTimeout((function(){e(i.target).removeClass("longpressed")}),250))})),n.on("longpress",(function(i){if("ION-ICON"==i.target.tagName&&("thumbs-down-sharp"==i.target.name||"thumbs-up-sharp"==i.target.name)){var n=e(i.target);n.addClass("longpressed").attr("color","purple").siblings().removeAttr("color").one("mouseleave",(function(){n.removeClass("longpressed")}))}})),n.on("click","ion-slide p.actions ion-icon, ion-slide p.added_actions ion-icon",(function(){var i=e(this);setTimeout((function(){var e=["checkmark-sharp","close-sharp","eye-off-sharp","pricetag-outline"];if(n.trigger("training-get-excepted-icon-names",[e]),!i.attr("name").match(new RegExp(e.join("|")))){if(("primary"==i.attr("color")||"purple"==i.attr("color"))&&!i.hasClass("longpressed")){var t=[!0],o=i.parent("ion-badge");if(n.trigger("training-check-can-be-deselected",[o,t]),t[0])return void i.removeAttr("color");"purple"==i.attr("color")&&(o.addClass("was_purple"),setTimeout((function(){o.removeClass("was_purple")}),1e3))}i.siblings().removeAttr("color"),i.hasClass("longpressed")?i.removeClass("longpressed"):i.attr("color","primary")}}),1)})),n.on("click","ion-slide p.actions ion-badge",(function(){var i=e(this),t=i.find("ion-icon"),o=t.attr("name"),a=[void 0!==o&&null!==o.match(/checkmark-sharp|close-sharp/)];n.trigger("training-can-like-unlike",[{$badge:i,$icon:t,can_train:a}]),a[0]&&(t.siblings("ion-label:visible").length||t.parent().removeClass("icon_only").parent().find(".train_up, .train_down").removeClass("ion-hide").find("ion-icon").addClass("ion-float-left right5px").siblings("ion-label").removeClass("ion-hide"),"primary"!=t.attr("color")?(t.attr("color","primary"),"checkmark-sharp"==o?i.parent().find('ion-icon[name="close-sharp"]').removeAttr("color"):i.parent().find('ion-icon[name="checkmark-sharp"]').removeAttr("color")):t.removeAttr("color"))})),n.on("click","ion-slide p.actions ion-label, ion-slide p.added_actions ion-label",(function(){var i=e(this).parent(),t=["train_up","train_down","labels"];n.trigger("training-get-ignoring-excepted-class-names",[t]),i.attr("class").match(new RegExp(t.join("|")))||(i.toggleClass("ignored").css("background-color",i.hasClass("ignored")?"#F4F4F4":i.data("unignored-color")).attr("title",i.hasClass("ignored")?window.lang.word_ignored_from_scoring:i.find("ion-label").text()),i.find("ion-icon").toggleClass("ion-hide").each((function(){var i=e(this);i.hasClass("ion-hide")?i.data("trained-color",i.attr("color")).removeAttr("color"):void 0!==i.data("trained-color")&&i.attr("color",i.data("trained-color")).removeData("trained-color")})))})),n.on("click","ion-slide p.added_actions ion-label",(function(){var i=e(this).parent(),t=[];n.trigger("training-get-removal-supported-class-names",[t]),i.attr("class").match(new RegExp(t.join("|")))&&(i.toggleClass("removal").css("background-color",i.hasClass("removal")?"":i.data("unremoved-color")).attr("color",i.hasClass("removal")?"danger":"").attr("title",i.hasClass("removal")?window.lang.item_will_be_removed:i.find("ion-label").text()),i.find("ion-icon").toggleClass("ion-hide").each((function(){var i=e(this);i.hasClass("ion-hide")?i.data("trained-color",i.attr("color")).removeAttr("color"):void 0!==i.data("trained-color")&&i.attr("color",i.data("trained-color")).removeData("trained-color")})))})),n.on("item-training-detailed",(function(e,i){t||o||(t=!0,n.trigger("show-loading"),function(e){o=!0;var i={ids:[]};if(void 0!==e&&void 0!==e.$element?i.ids.push(e.$element.find("ion-item").data("id")):i.ids=Object.keys(feedit.getSelectedItemsCache()).slice(0,25),!i.ids.length)return console.log("Error: no items to train, data:",e,", selected:",feedit.getSelectedItemsCache()),o=!1,void(t=!1);feedit.callAPI("api/training-modal.php",i,(function(e){"object"==typeof e?(async function(){n.trigger("open-modal",[await modalController.create({component:"modal-training",componentProps:{items:e}})])}(),t=!1):(n.trigger("hide-loading"),feedit.presentToast({txt:window.lang.ajax_error_maintenance,duration:2e4}))}),null,(function(){o=!1,t=!1}))}(i))})),n.on("train-simple-multi",(function(e,i){s(i.way,void 0!==i.dont_refresh_content&&i.dont_refresh_content)})),n.on("click","#multi_vote_up",(function(i){var n=e(this);if(n.hasClass("longpressed"))return n.removeClass("longpressed"),!0;s("up",!!i.shiftKey)})),n.on("longpress","#multi_vote_up",(function(){e(this).addClass("longpressed"),s("up",!0)})),n.on("click","#multi_vote_down",(function(i){var n=e(this);if(n.hasClass("longpressed"))return n.removeClass("longpressed"),!0;s("down",!!i.shiftKey)})),n.on("longpress","#multi_vote_down",(function(){e(this).addClass("longpressed"),s("down",!0)})),n.on("click","#multi_train",(function(){n.trigger("item-training-detailed")})),n.on("click","#multi_mark_read",(function(i){var t=e(this);if(t.hasClass("longpressed"))return t.removeClass("longpressed"),!0;var o={items:Object.keys(feedit.getSelectedItemsCache())},l=!0;for(var s of o.items)if(e('#main ion-item-sliding ion-item[data-id="'+s+'"] h2.unread').length){l=!1;break}n.trigger("item-read",[o,{successCallback:function(){!l&&a&&feedit.hide_all_selected_items()}}])})),n.on("longpress","#multi_mark_read",(function(){e(this).addClass("longpressed"),n.trigger("item-read",[{items:Object.keys(feedit.getSelectedItemsCache())}]),feedit.hide_all_selected_items()})),n.on("click","#main ion-badge.train_up",(function(){var i=e(this);feedit.getSelectedItemsCache()[i.closest("ion-item").data("id")]?d(i,"up",!1,feedit.getSelectedItemsCache()[i.closest("ion-item").data("id")]):d(i,"up")})),n.on("click","#main ion-badge.train_down",(function(){var i=e(this);feedit.getSelectedItemsCache()[i.closest("ion-item").data("id")]?d(i,"down",!1,feedit.getSelectedItemsCache()[i.closest("ion-item").data("id")]):d(i,"down")})),n.on("click","ion-badge.train",(function(){n.trigger("item-training-detailed",{$element:e(this).closest("ion-item-sliding")})})),n.on("keydown",(function(e){a=e.shiftKey?1:0})),n.on("keyup",(function(e){a=e.shiftKey?1:0})),n.on("item-training",(function(i,t,o,a){if(feedit.showMainTitleLoadingIndicator(),feedit.change_pagination_to_reload(),void 0===t.items)n.trigger("show-loading");else for(var l of t.items){var s=e('#main ion-item-sliding ion-item[data-id="'+l+'"]');s.find("h2.unread").removeClass("unread"),-1!=t.rating?s.addClass("item_is_trained"):s.removeClass("item_is_trained")}feedit.callAPI("api/training-simple.php",t,(function(i){if(""==i){if(void 0!==t.items){for(var a of t.items)e('#main ion-item-sliding ion-item[data-id="'+a+'"]').find("ion-badge.prediction").remove();feedit.show_hide_cleanup_icon()}else n.trigger("refresh-content",[null,null,null,{first_load:!0}]),e("#feed_cleanup_icon").addClass("ion-hide");n.trigger("refresh-link-counts",[{what:"all"},feedit.refreshMainTitle]),"function"==typeof o&&o()}else feedit.defaultErrorNotification()}),null,(function(){n.trigger("hide-loading"),feedit.hideMainTitleLoadingIndicator(),"function"==typeof a&&a()}))})),n.on("item-read",(function(i,t,o){if("all"==t.items)n.trigger("show-loading");else{for(var a in t.items){var l=t.items[a];e('ion-item[data-id="'+l+'"] h2.unread').length?(e('ion-item[data-id="'+l+'"] h2.unread').removeClass("unread"),t.items[a]={id:l,read:1}):(e('ion-item[data-id="'+l+'"] h2:first').addClass("unread"),t.items[a]={id:l,read:0})}feedit.show_hide_cleanup_icon()}feedit.callAPI("api/training-mark-read.php",t,(function(i){""==i?(void 0!==o&&"function"==typeof o.successCallback&&o.successCallback(),"all"==t.items&&(n.trigger("refresh-content",[null,null,null,{first_load:!0}]),e("#feed_cleanup_icon").addClass("ion-hide")),n.trigger("refresh-link-counts",[{what:"all"},feedit.refreshMainTitle])):feedit.defaultErrorNotification()}),null,(function(){n.trigger("hide-loading"),"function"==typeof alwaysCallback&&alwaysCallback()}))})),n.on("click",".training_unhide",(function(){e(this).addClass("ion-hide").next("p").removeClass("ion-hide")})),n.on("click","#training_confirm",(function(){var i;(i=function(){var i=[];return e("#training_slider ion-slide").each((function(){var t=e(this),o={id:t.data("id")};!function(i,t){i.find('ion-icon[color="primary"], ion-icon[color="purple"]').each((function(){var o=e(this),a=o.parent();if("close-sharp"==o.attr("name")||"checkmark-sharp"==o.attr("name")){var l="checkmark-sharp"==o.attr("name")?1:0;void 0!==i.data("was-trained")&&i.data("original-training")==l||(t.rate=l)}else if("thumbs-down-sharp"==o.attr("name")||"thumbs-up-sharp"==o.attr("name")){var s="thumbs-up-sharp"==o.attr("name")?300:-300;"purple"==o.attr("color")&&(s="thumbs-up-sharp"==o.attr("name")?3e3:-3e3),n.trigger("training-data-gather",[{gather_type:"basic",badge_type:a.data("type"),$icon:o,intensity:s,data:t}])}}))}(t,o),function(e,i){1!=e.data("was-trained")||2!=e.find("ion-badge.train_up, ion-badge.train_down").not(".ion-hide").length||e.find('ion-icon[name="checkmark-sharp"].ion-color-primary, ion-icon[name="close-sharp"].ion-color-primary').length||(i.rate="-1")}(t,o),function(i,t){i.find("ion-badge.ignored").each((function(){var i=e(this);1!=i.data("was-ignored")&&n.trigger("training-data-gather",[{gather_type:"new_ignored",$badge:i,badge_type:i.data("type"),data:t}])}))}(t,o),function(i,t){i.find('ion-badge[data-was-ignored="1"]').each((function(){var i=e(this);i.hasClass("ignored")||i.find('ion-icon[color="primary"], ion-icon[color="purple"]').length||n.trigger("training-data-gather",[{gather_type:"prev_ignored",$badge:i,badge_type:i.data("type"),data:t}])}))}(t,o),function(i,t){i.find("ion-badge.removal").each((function(){var i=e(this);n.trigger("training-data-gather",[{gather_type:"removal",$badge:i,badge_type:i.data("type"),data:t}])}))}(t,o),Object.keys(o).length>1&&i.push(o)})),!!i.length&&i}())&&(feedit.change_pagination_to_reload(),n.trigger("show-loading"),feedit.callAPI("api/training-detailed.php",{data:i},(function(t){if(""==t||t.auto_rated_items){for(var o in i){var l=e('#main ion-item-sliding ion-item[data-id="'+i[o].id+'"]');if(l.find("ion-badge.prediction").remove(),void 0!==i[o].rate||void 0!==t.auto_rated_items&&void 0!==t.auto_rated_items[i[o].id]){var s=void 0!==i[o].rate?i[o].rate:t.auto_rated_items[i[o].id];switch(parseInt(s)){case 0:feedit.isSimpleMode()?(l.find(".train_up, .trained_up").removeClass("shown-outside-simple-mode").addClass("ion-hide"),l.find(".train_down, .trained_down").addClass("shown-outside-simple-mode").not(".train_down").removeClass("ion-hide")):(l.find(".train_up, .trained_up").addClass("ion-hide"),l.find(".train_down, .trained_down").removeClass("ion-hide")),l.addClass("item_is_trained");break;case 1:feedit.isSimpleMode()?(l.find(".train_up, .trained_up").addClass("shown-outside-simple-mode").not(".train_up").removeClass("ion-hide"),l.find(".train_down, .trained_down").removeClass("shown-outside-simple-mode").addClass("ion-hide")):(l.find(".train_up, .trained_up").removeClass("ion-hide"),l.find(".train_down, .trained_down").addClass("ion-hide")),l.addClass("item_is_trained");break;case-1:feedit.isSimpleMode()?l.find(".train_up, .trained_up, .train_down, .trained_down").addClass("shown-outside-simple-mode"):l.find(".train_up, .trained_up, .train_down, .trained_down").removeClass("ion-hide"),l.removeClass("item_is_trained")}}}if(n.trigger("refresh-link-counts",[{what:"all"},feedit.refreshMainTitle]),feedit.presentToast({txt:window.lang.training_successful}),"function"==typeof successCallback&&successCallback(),a)if(i.length>1)feedit.hide_all_selected_items();else for(var o in i)feedit.hide_single_item(e('#main ion-item-sliding ion-item[data-id="'+i[o].id+'"]'));feedit.show_hide_cleanup_icon()}else feedit.defaultErrorNotification()}),null,(function(){n.trigger("hide-loading")}))),n.trigger("dismiss-modal")})),e("ion-content").on("click",".item_link",(function(i){!i.shiftKey&&e(".selected_item").length&&i.preventDefault()})),e("ion-content").on("mouseup",".item_link",(function(i){if(3===i.which)return!0;var t=e(this).closest("ion-item");t.hasClass("highlight_action_occured")||!t.find("h2.unread").length||e(".selected_item").length||n.trigger("item-read",[{items:[t.data("id")]}])})),e.extend(feedit,{markFeedRead(e){n.trigger("item-read",[{feed:e,items:"all"}])},trainAllUp(e){n.trigger("item-training",[{feed:e,rating:1}])},trainAllDown(e){n.trigger("item-training",[{feed:e,rating:0}])},change_pagination_to_reload(){if("score"==e("#filter_sort").val()){var i=e("#prev_page, #next_page").not(".force_reload");i.length&&i.addClass("force_reload").find("ion-label").html('<ion-icon name="sync-outline" class="right5px"></ion-icon> '+window.lang.reload_content_changed)}},show_hide_cleanup_icon(){e("#main ion-item-sliding:not(.ion-hide) ion-item h2").not(".feed_body, .unread").length||e(".item_is_trained:visible").length?e("#feed_cleanup_icon").length?e("#feed_cleanup_icon").removeClass("ion-hide"):e("#active_feed_title_header > span").prepend('<ion-icon id="feed_cleanup_icon" title="'+window.lang.hide_all_trained_articles+'" name="checkmark-done-outline" class="right5px ion-float-left"></ion-icon>'):e(".item_is_trained:visible").length||e("#feed_cleanup_icon").addClass("ion-hide").removeClass("re-show-after-load")}})}))}(jQuery),function(e){var i=e(document),n=!1,t=null,o=!1;i.on("app-init",(function(){customElements.define("modal-phrase-adjuster",class extends HTMLElement{connectedCallback(){this.innerHTML=`\n  <ion-header>\n    <ion-toolbar>\n      <ion-title>${window.lang.phrase_editing}</ion-title>\n      <ion-buttons slot="primary">\n        <ion-button onClick="feedit.dismissModal()">\n          <ion-icon slot="icon-only" name="close"></ion-icon>\n        </ion-button>\n      </ion-buttons>\n    </ion-toolbar>\n  </ion-header>\n  <ion-content class="ion-padding" id="phrase_adjuster_modal">\n    <ion-input id="phraseAdjuster" value="`+feedit.getTopModal().componentProps.phrase+`"></ion-input>\n    \n    <br>\n    <br>\n\n    <div class="ion-float-right top10px">\n      <a href="javascript:feedit.dismissModal()" class="ion-margin">${window.lang.cancel}</a>\n      <ion-button color="primary" id="update_phrase">${window.lang.confirm}</ion-button>\n    </div>\n  </ion-content>`}}),i.on("click","ion-badge.new_phrase",(function(){o||(o=!0,i.trigger("show-loading"),async function(e){i.trigger("open-modal",[await modalController.create({component:"modal-phrase-adjuster",componentProps:{phrase:e}})]),o=!1}(e(this).find("ion-label").html()))})),i.on("click","#update_phrase",(function(){e("ion-badge.new_phrase ion-label").html(e("#phraseAdjuster").val()),feedit.dismissModal(),e(".new_phrase_confirm").click()})),i.on("training-data-gather",(function(e,i){"phrase"==i.badge_type&&("basic"==i.gather_type?(i.data.phrases||(i.data.phrases=[]),i.data.phrases.push({text:i.$icon.siblings("ion-label").text(),rate:"thumbs-up-sharp"==i.$icon.attr("name")?1:0,rate_intensity:i.intensity})):"removal"!=i.gather_type||i.$badge.hasClass("newly_added")||(i.data.phrases||(i.data.phrases=[]),i.data.phrases.push({text:i.$badge.find("ion-label").text(),rate:-1})))})),i.on("training-modal-add-columns",(function(e,i){i.push(`\n              <ion-col data-id="phrases" class="ion-no-padding training_switchbox_column">\n                <ion-tab-button>\n                  <ion-icon name="pencil"></ion-icon>\n                  <ion-label>${window.lang.phrases}</ion-label>\n                </ion-tab-button>\n              </ion-col>`)})),i.on("training-modal-add-html",(function(e,i){if("phrases"==i.type){if(i.html_array.push(`\n            <p class="added_actions training_content_phrases ion-hide">\n              <ion-icon name="information-circle-outline" class="right5px custom_phrase_info" title="${window.lang.what_is_custom_phrase}" onclick="feedit.showHelp(this, 'train-add-phrase')"></ion-icon>\n              <ion-badge class="add_phrase" color="primary">\n                <ion-icon name="add-circle" class="ion-float-left right10px"></ion-icon>\n                <ion-label class="right5px">${window.lang.additional_phrase}</ion-label>\n              </ion-badge>`),i.item.phrases)for(var n of i.item.phrases)i.html_array.push('\n              <ion-badge class="phrase_label right5px" style="background-color: '+n.bg_color+'" data-unremoved-color="'+n.bg_color+'" title="'+n.text+`" data-id="${n.text}" data-type="phrase">\n                <ion-icon name="close-circle" class="ion-float-left right10px ion-hide"></ion-icon>\n                <ion-icon name="thumbs-down-sharp" class="ion-float-left right10px"></ion-icon>\n                <ion-label>${n.text}</ion-label>\n                <ion-icon name="thumbs-up-sharp" class="ion-float-right left10px"></ion-icon>\n              </ion-badge>`);i.html_array.push("\n              </p>")}})),i.on("training-get-excepted-icon-names",(function(e,i){i.push("add-circle"),i.push("information-circle-outline"),i.push("close-circle")})),i.on("training-get-ignoring-excepted-class-names",(function(e,i){i.push("new_phrase"),i.push("add_phrase"),i.push("custom_phrase"),i.push("phrase_label")})),i.on("training-get-removal-supported-class-names",(function(e,i){i.push("phrase_label")})),i.on("training-can-like-unlike",(function(e,i){!1!==i.can_train[0]&&(i.$badge.hasClass("new_phrase")||i.$badge.hasClass("add_phrase"))&&(i.can_train[0]=!1)})),i.on("training-check-can-be-deselected",(function(e,i,n){!1!==n[0]&&i.hasClass("phrase_label")&&i.hasClass("newly_added")&&(n[0]=!1,setTimeout((function(){i.hasClass("was_purple")||i.find('ion-icon[color="purple"]').length||feedit.presentToast({txt:window.lang.new_phrases_need_rating})}),750))})),i.on("click","ion-slide ion-badge.add_phrase",(function(){var i=e(this);i.hasClass("adding")?(i.attr("color","primary").removeClass("adding").find("ion-icon").attr("name","add-circle").next("ion-label").html(window.lang.additional_phrase),e("ion-badge.new_phrase").remove(),e("ion-slides").css({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none","-webkit-tap-highlight-color":"transparent","-webkit-touch-callout":"none"}).get(0).lockSwipes(!1),n=!1,t=null):(i.attr("color","danger").addClass("adding").find("ion-icon").attr("name","close-circle").next("ion-label").html(window.lang.cancel_adding_a_phrase),i.parent().append(`\n            <ion-badge class="new_phrase" color="tertiary">\n              <ion-icon name="close-circle" class="ion-float-left right10px ion-hide"></ion-icon>\n              <ion-label class="ion-padding-start new_phrase_label">${window.lang.select_phrase_from_article}</ion-label>\n              <ion-icon name="checkmark-sharp" class="new_phrase_confirm ion-float-right left10px"></ion-icon>\n            </ion-badge>`),e("ion-slides").css({"-webkit-user-select":"auto","-moz-user-select":"auto","-ms-user-select":"auto","user-select":"auto","-webkit-tap-highlight-color":"currentColor","-webkit-touch-callout":"inherit"}).get(0).lockSwipes(!0),n=!0,t=e(".new_phrase_label"),feedit.presentToast({txt:window.lang.select_text_or_click_phrase_label,duration:4e3}))})),i.on("mousemove touchmove mouseup touchend touchcancel selectionchange",".link_content, .link_anchor",(function(){if(n){var e="";window.getSelection?e=window.getSelection():document.getSelection?e=document.getSelection():document.selection&&(e=document.selection.createRange().text),""+e&&setTimeout((function(){null!==t&&t.html(""+e)}),100)}})),i.on("click",".new_phrase_confirm",(function(){var i=e("ion-badge.new_phrase"),n=i.find("ion-label");if(n.html()&&n.html()!=window.lang.select_phrase_from_article&&!e(".phrase_label ion-label").filter((function(){return this.innerHTML===n.html()})).length)return i.toggleClass("new_phrase newly_added phrase_label").css("background-color","#ffffb3").attr("title",n.html()).data({id:"new",type:"phrase","unremoved-color":"#ffffb3"}),n.removeClass("new_phrase_label ion-padding-start"),i.prepend('<ion-icon name="thumbs-down-sharp" class="ion-float-left right10px"></ion-icon>').append('<ion-icon name="thumbs-up-sharp" class="ion-float-right left10px" color="primary"></ion-icon>'),e(".new_phrase_confirm").remove(),i.parent().find(".add_phrase").click(),!1;i.parent().find(".add_phrase").click()}))}))}(jQuery),function(e){var i=jQuery(document);i.on("app-init",(function(){i.on("training-data-gather",(function(e,i){"word"==i.badge_type&&("basic"==i.gather_type?(i.data.words||(i.data.words=[]),i.data.words.push({word:i.$icon.siblings("ion-label").text(),rate:"thumbs-up-sharp"==i.$icon.attr("name")?1:0,rate_intensity:i.intensity})):"new_ignored"==i.gather_type?(i.data.words||(i.data.words=[]),i.data.words.push({word:i.$badge.find("ion-label").text(),rate:-1})):"prev_ignored"==i.gather_type&&(i.data.words||(i.data.words=[]),i.data.words.push({word:i.$badge.find("ion-label").text(),rate:2})))})),i.on("training-modal-add-html",(function(e,i){if("words"==i.type){if(i.html_array.push('\n              <p class="added_actions training_content_words">'),i.item.words)for(var n of i.item.words)i.html_array.push('\n                <ion-badge class="word_label '+(n.ignored?"ignored ":"")+'right5px" style="background-color: '+(n.ignored?i.ignored_badge_bg_color:n.bg_color)+`" data-unignored-color="${n.bg_color}" title="`+(n.ignored?window.lang.word_ignored_from_scoring:n.word)+'"'+(n.ignored?' data-was-ignored="1"':"")+` data-id="${n.word}" data-type="word">\n                  <ion-icon name="eye-off-sharp" class="ion-float-left right10px`+(n.ignored?"":" ion-hide")+'"></ion-icon>\n                  <ion-icon name="thumbs-down-sharp" class="ion-float-left right10px'+(n.ignored?" ion-hide":"")+`"></ion-icon>\n                  <ion-label>${n.word}</ion-label>\n                  <ion-icon name="thumbs-up-sharp" class="ion-float-right left10px`+(n.ignored?" ion-hide":"")+'"></ion-icon>\n                </ion-badge>');i.html_array.push("\n              </p>")}}))}))}();